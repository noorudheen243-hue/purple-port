import{q as _,r as M,x as I,j as e,J as L,a as P,u as V}from"./index-CVFz3GnQ.js";import{a1 as q,i as R,S as A,I as x,B as b,u as k}from"./index-MXZ1Fyy1.js";import{L as d}from"./label-BDi2E6m5.js";import{S as F,a as B,b as G,c as O,d as y}from"./select-CRNC5CBq.js";import{T as H}from"./textarea-D2C36G61.js";import{C as p,a as g,b as u,c as N}from"./card-L7c9AA96.js";import{T as K,a as X,b as T,c as o,d as $,e as l}from"./table-DEHLnAz_.js";import{A as Q}from"./arrow-left-BOi8SXvp.js";import"./index-C_y8q7n2.js";import"./index-COFXZIMB.js";const U=({clientId:v,onSuccess:m})=>{const s=_(),{register:t,handleSubmit:S,reset:c}=q(),[h,j]=M.useState("Search"),a=R({mutationFn:async n=>await I.post("/client-portal/tracking/google-ads",{client_id:v,date:n.date,campaign_name:n.campaign_name,campaign_type:h,spend:n.spend,clicks:n.clicks,impressions:n.impressions,conversions:n.conversions,cpa:n.cpa,notes:n.notes}),onSuccess:()=>{s.invalidateQueries({queryKey:["google-ads-logs"]}),A.fire("Saved","Daily record added successfully","success"),c(),m&&m()},onError:n=>{var f,C;A.fire("Error",((C=(f=n.response)==null?void 0:f.data)==null?void 0:C.message)||"Failed to save","error")}}),E=n=>{a.mutate(n)};return e.jsxs(p,{className:"mb-8 border-primary/20 bg-primary/5",children:[e.jsx(g,{children:e.jsx(u,{className:"text-lg",children:"Add Daily Entry"})}),e.jsx(N,{children:e.jsxs("form",{onSubmit:S(E),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Date"}),e.jsx(x,{type:"date",...t("date"),defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Campaign Name"}),e.jsx(x,{...t("campaign_name"),placeholder:"e.g. Brand Search",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Campaign Type"}),e.jsxs(F,{onValueChange:j,defaultValue:h,children:[e.jsx(B,{children:e.jsx(G,{placeholder:"Type"})}),e.jsxs(O,{children:[e.jsx(y,{value:"Search",children:"Search"}),e.jsx(y,{value:"Display",children:"Display"}),e.jsx(y,{value:"Video",children:"Video (YouTube)"}),e.jsx(y,{value:"Performance Max",children:"Performance Max"}),e.jsx(y,{value:"Shopping",children:"Shopping"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Spend (₹)"}),e.jsx(x,{type:"number",step:"0.01",...t("spend"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Impressions"}),e.jsx(x,{type:"number",...t("impressions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Clicks"}),e.jsx(x,{type:"number",...t("clicks")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Conversions"}),e.jsx(x,{type:"number",...t("conversions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"CPA"}),e.jsx(x,{type:"number",step:"0.01",...t("cpa")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Notes (Optional)"}),e.jsx(H,{...t("notes"),placeholder:"Campaign observations..."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(b,{type:"submit",disabled:a.isPending,children:a.isPending?"Saving...":"Save Record"})})]})})]})},ce=()=>{const[v]=L(),m=P(),{user:s}=V(),t=v.get("clientId"),S=v.get("mode"),c=(s==null?void 0:s.role)==="CLIENT"?s==null?void 0:s.linked_client_id:t,h=(s==null?void 0:s.role)==="ADMIN"||(s==null?void 0:s.role)==="MANAGER"||(s==null?void 0:s.role)==="DEVELOPER_ADMIN"||(s==null?void 0:s.role)==="MARKETING_EXEC"||(s==null?void 0:s.role)==="DM_EXECUTIVE"||(s==null?void 0:s.role)==="WEB_SEO_EXECUTIVE"||(s==null?void 0:s.role)==="CREATIVE_DESIGNER"||(s==null?void 0:s.role)==="OPERATIONS_EXECUTIVE",j=h&&S==="manage",{data:a,isLoading:E}=k({queryKey:["google-ads-logs",c],queryFn:async()=>{if(!c)return[];const{data:i}=await I.get(`/client-portal/tracking/google-ads?clientId=${c}`);return i},enabled:!!c}),{data:n}=k({queryKey:["client-details-google",c],queryFn:async()=>(await I.get(`/clients/${c}`)).data,enabled:!!c});if(!c)return e.jsx("div",{className:"p-8 text-center",children:"No Client Selected"});const f=(a==null?void 0:a.reduce((i,r)=>i+(r.spend||0),0))||0,C=(a==null?void 0:a.reduce((i,r)=>i+(r.clicks||0),0))||0,w=(a==null?void 0:a.reduce((i,r)=>i+(r.conversions||0),0))||0,D=(a==null?void 0:a.length)>0?a.reduce((i,r)=>i+(r.cpa||0),0)/a.length:0;return e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>m(-1),children:[e.jsx(Q,{className:"mr-2 h-4 w-4"})," Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Google Ads Performance"}),n&&e.jsx("p",{className:"text-muted-foreground",children:n.name})]})]}),h&&!j&&e.jsx(b,{variant:"outline",onClick:()=>m(`?mode=manage&clientId=${c}`),children:"Add Entry / Manage"}),j&&e.jsx("div",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded text-xs font-bold uppercase tracking-wider",children:"Management Mode"})]}),j&&e.jsx(U,{clientId:c}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(p,{children:[e.jsx(g,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-gray-500",children:"Total Spend"})}),e.jsx(N,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["₹",f.toLocaleString()]})})]}),e.jsxs(p,{children:[e.jsx(g,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-gray-500",children:"Clicks"})}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl font-bold",children:C.toLocaleString()})})]}),e.jsxs(p,{children:[e.jsx(g,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-gray-500",children:"Conversions"})}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl font-bold",children:w.toLocaleString()})})]}),e.jsxs(p,{children:[e.jsx(g,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-gray-500",children:"Avg CPA"})}),e.jsx(N,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["₹",D.toFixed(2)]})})]})]}),e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(u,{children:"Campaign History"})}),e.jsx(N,{children:E?e.jsx("div",{className:"text-center py-8",children:"Loading data..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(K,{children:[e.jsx(X,{children:e.jsxs(T,{children:[e.jsx(o,{children:"Date"}),e.jsx(o,{children:"Campaign"}),e.jsx(o,{children:"Type"}),e.jsx(o,{className:"text-right",children:"Spend"}),e.jsx(o,{className:"text-right",children:"Clicks"}),e.jsx(o,{className:"text-right",children:"Impressions"}),e.jsx(o,{className:"text-right",children:"Conversions"}),e.jsx(o,{className:"text-right",children:"CPA"}),e.jsx(o,{children:"Notes"})]})}),e.jsx($,{children:(a==null?void 0:a.length)>0?a.map(i=>{var r;return e.jsxs(T,{children:[e.jsx(l,{children:new Date(i.date).toLocaleDateString()}),e.jsx(l,{className:"font-medium",children:i.campaign_name}),e.jsx(l,{children:i.campaign_type}),e.jsxs(l,{className:"text-right font-mono",children:["₹",(r=i.spend)==null?void 0:r.toLocaleString()]}),e.jsx(l,{className:"text-right",children:i.clicks}),e.jsx(l,{className:"text-right",children:i.impressions}),e.jsx(l,{className:"text-right",children:i.conversions}),e.jsxs(l,{className:"text-right",children:["₹",i.cpa]}),e.jsx(l,{className:"max-w-[150px] truncate",title:i.notes,children:i.notes||"-"})]},i.id)}):e.jsx(T,{children:e.jsx(l,{colSpan:9,className:"text-center h-32 text-muted-foreground",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx("p",{children:"No records found."}),h&&!j&&e.jsx(b,{variant:"outline",size:"sm",onClick:()=>m(`?mode=manage&clientId=${c}`),children:"Add First Daily Entry"})]})})})})]})})})]})]})};export{ce as default};
