import{v as Z,r as d,j as e,x as f,E as ee,F as se,q as te,C as ae,L as T}from"./index-CVFz3GnQ.js";import{a1 as F,u as B,X as re,g as le,f as z,ag as ne,n as ie,i as de,B as I,p as oe,$ as ce,ah as xe,J as me,R as O,ai as ue,K as he,l as pe,L as ge,D as fe,a as je,d as be,e as ye,aj as Ne,k as ve}from"./index-MXZ1Fyy1.js";import{B as we}from"./ImageUpload-B3ISCpRG.js";import{C as Se,S as Ee}from"./StaffFormModal-aJC9IbI1.js";import{G as ke}from"./compat-JR35noTw.js";import{S as Ae}from"./save-Ch7_aoOB.js";import{F as Ce}from"./filter-wAG_XgtK.js";import{C as Le}from"./check-circle-C7q7Y3EO.js";import{P as Me}from"./phone-CbVTifaP.js";import{S as _e}from"./square-pen-Sra3cVmY.js";import"./loader-2-BN6j0axX.js";import"./FormErrorAlert-DfwZ5q27.js";import"./alert-circle-DVBvcfOk.js";/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=Z("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Te=[{id:1,label:"Personal",icon:le},{id:2,label:"Professional",icon:we},{id:3,label:"Financial",icon:Se},{id:4,label:"Review",icon:z}],Ie=({onClose:h,onSuccess:x})=>{const[n,j]=d.useState(1),{register:a,handleSubmit:b,watch:E,trigger:p,formState:{errors:y}}=F(),[o,N]=d.useState(""),g=E(),{data:m}=B({queryKey:["accountHeads"],queryFn:async()=>(await f.get("/accounting/heads")).data}),v=async()=>{await p()&&j(w=>w+1)},k=()=>j(r=>r-1),u=async r=>{try{await f.post("/auth/register",{...r,staff_number:r.staff_number||`EMP${Math.floor(Math.random()*1e3)}`}),await f.post("/team/staff/onboard",r),x(),h()}catch(w){console.error(w),alert("Onboarding failed")}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-900 text-white p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"New Staff Onboarding"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Create account, profile, and payroll ledger."})]}),e.jsx("button",{onClick:h,className:"text-slate-400 hover:text-white",children:e.jsx(re,{})})]}),e.jsx("div",{className:"flex border-b",children:Te.map(r=>e.jsx("div",{className:`flex-1 p-3 text-center text-sm font-medium border-b-2 ${n===r.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(r.icon,{size:16})," ",r.label]})},r.id))}),e.jsxs("form",{onSubmit:b(u),className:"p-6 overflow-y-auto flex-1",children:[n===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Full Name"}),e.jsx("input",{...a("full_name",{required:!0}),className:"w-full border p-2 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Email"}),e.jsx("input",{...a("email",{required:!0}),type:"email",className:"w-full border p-2 rounded"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Mobile"}),e.jsx("input",{...a("personal_contact"),className:"w-full border p-2 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"DOB"}),e.jsx("input",{...a("date_of_birth"),type:"date",className:"w-full border p-2 rounded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Address"}),e.jsx("textarea",{...a("address"),className:"w-full border p-2 rounded",rows:2})]})]}),n===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Role"}),e.jsxs("select",{...a("role",{required:!0}),className:"w-full border p-2 rounded",children:[e.jsx("option",{value:"MARKETING_EXEC",children:"Marketing Exec"}),e.jsx("option",{value:"DESIGNER",children:"Designer"}),e.jsx("option",{value:"WEB_SEO",children:"Web/SEO"}),e.jsx("option",{value:"MANAGER",children:"Manager"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Department"}),e.jsxs("select",{...a("department",{required:!0}),className:"w-full border p-2 rounded",children:[e.jsx("option",{value:"CREATIVE",children:"Creative"}),e.jsx("option",{value:"MARKETING",children:"Marketing"}),e.jsx("option",{value:"WEB",children:"Web Dev"}),e.jsx("option",{value:"MANAGEMENT",children:"Management"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Designation"}),e.jsx("input",{...a("designation"),className:"w-full border p-2 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Joining Date"}),e.jsx("input",{...a("date_of_joining",{required:!0}),type:"date",className:"w-full border p-2 rounded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Staff ID (Auto)"}),e.jsx("input",{...a("staff_number"),placeholder:"Leave blank to auto-generate",className:"w-full border p-2 rounded bg-gray-50"})]})]}),n===3&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4",children:[e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-100",children:[e.jsxs("h4",{className:"font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[e.jsx(ke,{size:18})," Finance Account (Ledger)"]}),e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("input",{type:"checkbox",...a("ledger_options.create"),className:"mt-1 w-4 h-4 text-purple-600 rounded border-gray-300 focus:ring-purple-500",id:"create_staff_ledger_wiz"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"create_staff_ledger_wiz",className:"font-medium text-gray-900 cursor-pointer text-sm",children:"Create/Link Ledger Account"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Track salary payable & advances automatically."})]})]}),E("ledger_options.create")&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:"Filter Type"}),e.jsxs("select",{value:o,onChange:r=>N(r.target.value),className:"w-full border p-2 rounded text-sm bg-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"ASSET",children:"Asset (Advances)"}),e.jsx("option",{value:"EXPENSE",children:"Expense"}),e.jsx("option",{value:"SoW",children:"Salary & Wages"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["Select Account Head ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...a("ledger_options.head_id"),className:"w-full border p-2 rounded text-sm bg-white",children:[e.jsx("option",{value:"",children:"-- Select Head --"}),m==null?void 0:m.filter(r=>!o||r.type===o||o==="SoW"&&r.name.includes("Salary")).map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.code,")"]},r.id))]})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Salary Type"}),e.jsxs("select",{...a("salary_type"),className:"w-full border p-2 rounded",children:[e.jsx("option",{value:"MONTHLY",children:"Monthly"}),e.jsx("option",{value:"CONTRACT",children:"Contract"})]})]})}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded border",children:[e.jsx("h4",{className:"font-medium text-sm mb-2 text-gray-700",children:"Bank Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{...a("bank_name"),placeholder:"Bank Name",className:"w-full border p-2 rounded text-sm"}),e.jsx("input",{...a("account_number"),placeholder:"Account Number",className:"w-full border p-2 rounded text-sm"}),e.jsx("input",{...a("ifsc_code"),placeholder:"IFSC Code",className:"w-full border p-2 rounded text-sm"}),e.jsx("input",{...a("pan_number"),placeholder:"PAN Number",className:"w-full border p-2 rounded text-sm"})]})]})]}),n===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded text-green-800 text-sm",children:[e.jsxs("h4",{className:"font-bold flex items-center gap-2",children:[e.jsx(z,{size:16})," Ready to Onboard"]}),e.jsx("p",{children:"This will create a User account, Staff Profile, and Payroll Ledger."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",g.full_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Role:"})," ",g.role]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",g.email]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Salary:"})," Manage in Payroll"]})]})]})]}),e.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-between",children:[e.jsx("button",{onClick:k,disabled:n===1,className:"px-4 py-2 rounded text-gray-600 hover:bg-white border transition disabled:opacity-50",children:"Back"}),n<4?e.jsx("button",{onClick:v,className:"px-4 py-2 rounded bg-slate-900 text-white hover:bg-slate-800 transition",children:"Next"}):e.jsx("button",{onClick:b(u),className:"px-6 py-2 rounded bg-green-600 text-white hover:bg-green-700 transition font-bold shadow-lg shadow-green-200",children:"Confirm Onboarding"})]})]})})},Oe=({staffId:h,staffName:x,onClose:n,onSuccess:j})=>{var m,v;const{register:a,handleSubmit:b,formState:{errors:E}}=F(),[p,y]=d.useState(1),[o,N]=d.useState(null),g=async k=>{try{const u=await f.post(`/team/staff/${h}/exit`,k);N(u.data),y(2)}catch(u){console.error("Exit failed",u),alert("Failed to initiate exit.")}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-600 mb-6 border-b pb-4",children:[e.jsx(ee,{size:28}),e.jsxs("h2",{className:"text-xl font-bold",children:["Initiate Exit: ",x]})]}),p===1?e.jsxs("form",{onSubmit:b(g),className:"space-y-4",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-md text-sm text-red-800",children:[e.jsx("strong",{children:"Warning:"})," This action will:",e.jsxs("ul",{className:"list-disc pl-5 mt-1 space-y-1",children:[e.jsx("li",{children:"Disable user login access after the Exit Date."}),e.jsx("li",{children:"Lock the Salary Ledger."}),e.jsx("li",{children:"Post a Final Settlement Journal Entry."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Working Day (Exit Date)"}),e.jsx("input",{type:"date",...a("exitDate",{required:!0}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 p-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason for Exit"}),e.jsx("textarea",{...a("reason",{required:!0}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 p-2 border",placeholder:"Resignation, Termination, etc."})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 font-medium",children:"Initiate Exit"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600",children:e.jsx(ne,{size:24})}),e.jsx("h3",{className:"text-lg font-medium",children:"Exit Process Initiated"}),e.jsx("p",{className:"text-gray-500",children:"Access has been scheduled for locking."})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border space-y-3",children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(ie,{size:18})," Final Settlement Preview"]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Pro-rata Salary:"}),e.jsxs("span",{className:"font-mono font-medium",children:["₹",(m=o==null?void 0:o.estimatedSettlement)==null?void 0:m.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Pending Deductions:"}),e.jsx("span",{className:"font-mono font-medium text-red-600",children:"- ₹0.00"})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold",children:[e.jsx("span",{children:"Net Payable:"}),e.jsxs("span",{children:["₹",(v=o==null?void 0:o.estimatedSettlement)==null?void 0:v.toLocaleString()]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>{j(),n()},className:"px-4 py-2 bg-gray-900 text-white rounded hover:bg-gray-800",children:"Close"})})]})]})})},Qe=()=>{var R;const h=se(),x=te(),[n,j]=d.useState(""),[a,b]=d.useState("ALL"),[E,p]=d.useState(!1),[y,o]=d.useState(null),[N,g]=d.useState(!1),[m,v]=d.useState(null),[k,u]=d.useState({MANAGEMENT:!0,MARKETING:!0,CREATIVE:!0,WEB_SEO:!0,WEB:!0,ADMIN:!0}),[r,w]=d.useState({}),[q,C]=d.useState(!1),W=s=>{u(i=>({...i,[s]:!i[s]}))},G=de({mutationFn:async s=>{await f.delete(`/team/staff/${s}`)},onSuccess:()=>{x.invalidateQueries({queryKey:["staff"]})},onError:s=>{var i,l;alert("Failed to delete member: "+(((l=(i=s.response)==null?void 0:i.data)==null?void 0:l.message)||s.message))}}),K=s=>{G.mutate(s)},U=(s,i)=>{w(l=>({...l,[s]:i}))},L=d.useMemo(()=>Object.keys(r).length,[r]),$=()=>{L>0&&C(!0)},V=async()=>{var s,i;C(!1);try{await Promise.all(Object.entries(r).map(([l,t])=>f.patch(`/team/staff/${l}`,{role:t}))),x.invalidateQueries({queryKey:["staff"]}),w({})}catch(l){console.error("Bulk save error:",l);const t=(i=(s=l.response)==null?void 0:s.data)==null?void 0:i.message;alert("Failed to update roles: "+(typeof t=="object"?JSON.stringify(t,null,2):t||l.message))}},H=s=>{o(s)};ae.useEffect(()=>{new URLSearchParams(h.search).get("action")==="new"&&p(!0)},[h.search]);const{data:D,isLoading:Q,error:J}=B({queryKey:["staff"],queryFn:async()=>(await f.get("/team/staff")).data}),M=d.useMemo(()=>Array.isArray(D)?D.filter(s=>{const l=(s.user||{}).full_name||"",t=s.designation||"",c=s.staff_number||"",A=l.toLowerCase().includes(n.toLowerCase())||t.toLowerCase().includes(n.toLowerCase())||c.toLowerCase().includes(n.toLowerCase()),_=a==="ALL"||a==="ALL_LIST"||s.department===a;return A&&_}):[],[D,n,a]),Y=d.useMemo(()=>{if(a==="ALL_LIST")return{"All Team Members":M};const s={};return["MANAGEMENT","MARKETING","CREATIVE","WEB_SEO","WEB","ADMIN"].forEach(l=>s[l]=[]),M.forEach(l=>{const t=l.department||"OTHER";s[t]||(s[t]=[]),s[t].push(l)}),s},[M,a]);return J?e.jsx("div",{className:"p-8 text-center text-red-500",children:"Failed to load team data."}):e.jsxs("div",{className:"space-y-6",children:[E&&e.jsx(Ie,{onClose:()=>p(!1),onSuccess:()=>{x.invalidateQueries({queryKey:["staff"]}),p(!1)}}),N&&e.jsx(Ee,{isOpen:N,onClose:()=>{g(!1),v(null)},initialData:m}),y&&e.jsx(Oe,{staffId:y.id,staffName:((R=y.user)==null?void 0:R.full_name)||"Staff Member",onClose:()=>o(null),onSuccess:()=>{x.invalidateQueries({queryKey:["staff"]})}}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Team Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your employees, their roles, and performance."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[L>0&&e.jsxs(I,{onClick:$,className:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[e.jsx(Ae,{size:16}),"Save ",L," Role Updates"]}),e.jsxs(T,{to:"/dashboard/team/onboard",className:"flex items-center gap-2 bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors",children:[e.jsx(De,{size:16}),"Add Member"]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-card p-4 rounded-lg border shadow-sm",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx("input",{type:"text",placeholder:"Search by name, ID, or designation...",className:"w-full pl-10 pr-4 py-2 bg-background border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/20",value:n,onChange:s=>j(s.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{size:18,className:"text-muted-foreground"}),e.jsxs("select",{className:"bg-background border rounded-md px-3 py-2 text-sm focus:outline-none",value:a,onChange:s=>b(s.target.value),children:[e.jsx("option",{value:"ALL",children:"All Departments (Grouped)"}),e.jsx("option",{value:"ALL_LIST",children:"All Team Members (List)"}),e.jsx("option",{value:"MANAGEMENT",children:"Management"}),e.jsx("option",{value:"MARKETING",children:"Marketing"}),e.jsx("option",{value:"CREATIVE",children:"Creative"}),e.jsx("option",{value:"WEB_SEO",children:"Web & SEO"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]})]})]}),Q?e.jsx("div",{className:"text-center py-12",children:"Loading team..."}):e.jsxs("div",{className:"space-y-8",children:[Object.entries(Y).map(([s,i])=>{if(i.length===0)return null;const l=k[s]??!0;return e.jsxs("div",{className:"border rounded-lg bg-card overflow-hidden shadow-sm",children:[e.jsx("button",{onClick:()=>W(s),className:"w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors border-b",children:e.jsxs("div",{className:"flex items-center gap-2",children:[l?e.jsx(ce,{size:20,className:"text-gray-500"}):e.jsx(xe,{size:20,className:"text-gray-500"}),e.jsx("h3",{className:"font-semibold text-lg text-gray-800",children:s.replace("_"," ")}),e.jsx("span",{className:"bg-white border px-2 py-0.5 rounded-full text-xs text-gray-500 font-medium",children:i.length})]})}),l&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50/50 dark:bg-slate-800/50 text-gray-500 dark:text-gray-400 font-medium border-b dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 pl-6",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Ledger"}),e.jsx("th",{className:"px-4 py-3",children:"ID Number"}),e.jsx("th",{className:"px-4 py-3",children:"Designation"}),e.jsx("th",{className:"px-4 py-3",children:"System Role"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"Date of Joining"}),e.jsx("th",{className:"px-4 py-3 text-right pr-6",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:i.map(t=>{var P;const c=t.user||{},A=r[t.id]||c.role||"N/A",_=r[t.id]&&r[t.id]!==c.role;return e.jsxs("tr",{className:`hover:bg-gray-50/30 group ${_?"bg-yellow-50/30":""}`,children:[e.jsx("td",{className:"px-4 py-3 pl-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs",children:c.avatar_url?e.jsx("img",{src:me(c.avatar_url),className:"w-full h-full rounded-full object-cover"}):(c.full_name||"?").charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 flex items-center gap-2",children:c.full_name||"Unknown"}),e.jsx(T,{to:`/dashboard/team/${t.id}`,className:"text-[10px] text-primary hover:underline",children:"View Profile"})]})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:(P=t.ledger_options)!=null&&P.create?e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-green-50 text-green-700 border border-green-200 text-[10px] font-medium",title:"Ledger Account Active",children:[e.jsx(Le,{size:10,className:"fill-green-100"})," Active"]}):e.jsx("span",{className:"text-gray-300 text-[10px]",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-gray-600 font-mono text-xs",children:t.staff_number}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:t.designation}),e.jsx("td",{className:"px-4 py-3",children:A===O.DEVELOPER_ADMIN?e.jsx("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded bg-red-600 text-white font-bold text-xs shadow-sm w-fit opacity-100 cursor-not-allowed select-none",children:e.jsx("span",{children:"Developer Admin"})}):e.jsx("select",{value:A,onChange:S=>U(t.id,S.target.value),className:`border-none text-xs font-medium focus:ring-0 cursor-pointer rounded px-1 py-0.5 transition-colors bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 ${_?"text-amber-600 font-bold":"text-gray-700 dark:text-gray-300"}`,children:Object.entries(ue).map(([S,X])=>S===O.DEVELOPER_ADMIN||S===O.CLIENT?null:e.jsx("option",{value:S,children:X},S))})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-0.5 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(he,{size:12})," ",c.email||"-"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Me,{size:12})," ",t.official_contact||t.personal_contact||"-"]})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:t.date_of_joining?new Date(t.date_of_joining).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3 text-right pr-6",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(T,{to:`/dashboard/team/edit/${t.id}`,className:"p-1.5 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded transition-colors",title:"Edit Member",children:e.jsx(_e,{size:16})}),A!=="DEVELOPER_ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this team member?")&&K(t.id)},className:"p-1.5 text-red-600 bg-red-50 hover:bg-red-100 rounded transition-colors",title:"Delete Member",children:e.jsx(pe,{size:16})}),e.jsx("button",{onClick:()=>H(t),className:"p-1.5 text-orange-600 bg-orange-50 hover:bg-orange-100 rounded transition-colors",title:"Initiate Exit",children:e.jsx(ge,{size:16})})]})]})})]},t.id)})})]})})]},s)}),M.length===0&&e.jsx("div",{className:"text-center py-12 text-muted-foreground bg-gray-50 rounded-lg border border-dashed",children:"No team members found matching your filters."})]}),e.jsx(fe,{open:q,onOpenChange:C,children:e.jsxs(je,{children:[e.jsxs(be,{children:[e.jsx(ye,{children:"Confirm Role Updates"}),e.jsxs(Ne,{children:["You are about to update the system roles for ",e.jsx("strong",{children:L})," team members.",e.jsx("br",{}),e.jsx("br",{}),"Are you sure you want to proceed?"]})]}),e.jsxs(ve,{children:[e.jsx(I,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),e.jsx(I,{className:"bg-green-600 hover:bg-green-700 text-white",onClick:V,children:"Yes, Update All"})]})]})})]})};export{Qe as default};
