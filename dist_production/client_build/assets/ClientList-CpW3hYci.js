import{v as E,r as u,j as e,q as A,A as S,z as D,w as _}from"./index-W29iofZb.js";import{R as I,P as L,O,n as $,X as F,p as T,U,M as q,u as V,d as B}from"./index-BJPAJU8j.js";import{G as C,C as R}from"./ClientFormModal-BKqcdBwf.js";import{T as W}from"./target-DsFD-ZfX.js";import{B as Q}from"./ImageUpload-hbeWa2wy.js";import{P as G}from"./phone-C_p3WBMo.js";import{P as J}from"./plus-DDoesenU.js";import{P as K}from"./pencil-p3rokjVt.js";import{T as Z}from"./trash-2-Z3LHyNR_.js";import"./FormErrorAlert-CeUQt-QP.js";import"./alert-circle-UM98rPg5.js";import"./building-C4hlH-CJ.js";import"./save-BK4gaAHr.js";import"./loader-2-CWSgfRxb.js";/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=E("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=E("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),X=({isOpen:f,onClose:h,client:t})=>{var l,j,o,N;const[i,y]=u.useState("core");if(!t)return null;const d=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return null}return s},v=s=>s?s.startsWith("http")||s.startsWith("blob:")?s:`${"http://localhost:4001/api".replace("/api","")}${s}`:"",c=d(t.service_engagement)||[],r=d(t.social_links)||{},p=d(t.customer_avatar)||{},b=d(t.competitor_info)||[],g=({id:s,label:n,icon:w})=>e.jsxs("button",{onClick:()=>y(s),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors flex-shrink-0 ${i===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-200"}`,children:[e.jsx(w,{size:16}),n]});return e.jsx(I,{open:f,onOpenChange:h,children:e.jsx(L,{children:e.jsx(O,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in transition-opacity",children:e.jsxs($,{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col focus:outline-none relative animate-in zoom-in-95 duration-200",children:[e.jsx("button",{onClick:h,className:"absolute top-4 right-4 p-2 bg-gray-100 hover:bg-gray-200 text-gray-500 rounded-full transition-colors z-[60]",children:e.jsx(F,{size:20})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start mb-8",children:[e.jsxs("div",{className:"w-32 h-32 bg-white rounded-xl shadow-md p-2 flex items-center justify-center border border-gray-100 flex-shrink-0 relative overflow-hidden",children:[t.logo_url?e.jsx("img",{src:v(t.logo_url),alt:t.name,className:"w-full h-full object-contain",onError:s=>{var n;s.target.style.display="none",(n=s.target.nextElementSibling)==null||n.classList.remove("hidden")}}):e.jsx("div",{className:"w-full h-full bg-blue-50 rounded-lg flex items-center justify-center text-primary",children:e.jsx(k,{size:40})}),e.jsx("div",{className:"hidden absolute inset-0 bg-gray-50 flex items-center justify-center text-gray-400",children:e.jsx(k,{size:32})})]}),e.jsxs("div",{className:"flex-1 pt-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:t.industry||"Industry N/A"}),e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-bold ${t.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.status})]})]})]}),e.jsxs("div",{className:"flex border-b mb-6 overflow-x-auto flex-shrink-0",children:[e.jsx(g,{id:"core",label:"Core Info",icon:k}),e.jsx(g,{id:"services",label:"Services",icon:W}),e.jsx(g,{id:"team",label:"Team",icon:T}),e.jsx(g,{id:"extended",label:"Extended",icon:Q}),e.jsx(g,{id:"strategy",label:"Strategy",icon:C})]}),e.jsxs("div",{className:"min-h-[300px]",children:[i==="core"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 animate-in fade-in",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Contact Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(U,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-sm",children:t.contact_person||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(q,{size:16,className:"text-gray-400"}),e.jsx("a",{href:`mailto:${t.company_email}`,className:"text-sm hover:text-primary hover:underline",children:t.company_email||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(G,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"text-sm",children:t.contact_number||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(C,{size:16,className:"text-gray-400"}),e.jsx("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",className:"text-sm hover:text-primary hover:underline",children:r.website||"N/A"})]}),e.jsxs("div",{className:"flex items-start gap-3 text-gray-700",children:[e.jsx(H,{size:16,className:"text-gray-400 mt-0.5"}),e.jsx("span",{className:"text-sm",children:t.address||"No address provided"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Account Manager"}),t.account_manager?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-700 font-bold text-sm",children:(l=t.account_manager.full_name)==null?void 0:l.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.account_manager.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.account_manager.email})]})]}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No account manager assigned."})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Assigned Execution Team"}),t.assigned_staff&&t.assigned_staff.length>0?e.jsx("div",{className:"space-y-2",children:t.assigned_staff.map(s=>{var n;return e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg border border-gray-100",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.full_name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-700 font-bold text-xs",children:(n=s.full_name)==null?void 0:n.charAt(0)}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.full_name})})]},s.id)})}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No execution team assigned."})]})]}),i==="services"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Engaged Services"}),c.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(s=>e.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm font-medium border border-blue-100",children:s},s))}):e.jsx("p",{className:"text-gray-500 italic text-sm",children:"No services listed."})]}),i==="team"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Assigned Team"}),e.jsx("p",{className:"text-sm text-gray-500 italic mb-4",children:"Team members assigned to this client account."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-md bg-purple-50/50",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-purple-700 font-bold text-xs",children:((o=(j=t.account_manager)==null?void 0:j.full_name)==null?void 0:o.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((N=t.account_manager)==null?void 0:N.full_name)||"Unassigned"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Account Manager"})]})]}),t.assigned_staff&&t.assigned_staff.length>0&&e.jsx(e.Fragment,{children:t.assigned_staff.map(s=>{var n;return e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-md bg-white hover:bg-gray-50 transition-colors",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.full_name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-700 font-bold text-xs",children:(n=s.full_name)==null?void 0:n.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Execution Team"})]})]},s.id)})})]})]}),i==="extended"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 animate-in fade-in",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Social Presence"}),e.jsxs("div",{className:"space-y-3",children:[r.facebook&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"Facebook:"})," ",e.jsx("a",{href:r.facebook,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.facebook})]}),r.instagram&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"Instagram:"})," ",e.jsx("a",{href:r.instagram,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.instagram})]}),r.linkedin&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"LinkedIn:"})," ",e.jsx("a",{href:r.linkedin,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.linkedin})]}),r.twitter&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"Twitter:"})," ",e.jsx("a",{href:r.twitter,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.twitter})]}),!r.facebook&&!r.instagram&&!r.linkedin&&!r.twitter&&e.jsx("p",{className:"text-gray-500 italic text-sm",children:"No social links configured."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Customer Avatar"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-800",children:p.description||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Pain Points"}),e.jsx("p",{className:"text-sm text-gray-800",children:p.pain_points||"N/A"})]})]})]})]}),i==="strategy"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Competitors"}),b.length>0?e.jsx("div",{className:"space-y-3",children:b.map((s,n)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:s.name}),s.website&&e.jsx("a",{href:s.website,target:"_blank",className:"text-xs text-blue-600 hover:underline",children:s.website})]},n))}):e.jsx("p",{className:"text-gray-500 italic text-sm",children:"No competitor info."})]})]})]})]})})})})},Y=({isOpen:f,onClose:h,onConfirm:t,title:i,message:y,type:d="danger"})=>f?e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-sm w-full p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:i}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:y}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md",children:"Cancel"}),e.jsx("button",{onClick:t,className:`px-4 py-2 text-sm font-medium text-white rounded-md ${d==="danger"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,children:"Confirm"})]})]})}):null,ge=()=>{const f=A(),h=S(),[t,i]=u.useState(!1),[y,d]=u.useState(!1),[v,c]=u.useState(!1),[r,p]=u.useState(null),[b,g]=u.useState(null),[l,j]=u.useState(null);D.useEffect(()=>{new URLSearchParams(h.search).get("action")==="new"&&(p(null),i(!0))},[h.search]);const{data:o,isLoading:N}=V({queryKey:["clients"],queryFn:async()=>{const{data:a}=await _.get("/clients");return a}}),s=B({mutationFn:async a=>{await _.delete(`/clients/${a}`)},onSuccess:()=>{f.invalidateQueries({queryKey:["clients"]}),c(!1)},onError:a=>{var x,m;alert("Failed to delete: "+(((m=(x=a.response)==null?void 0:x.data)==null?void 0:m.message)||a.message)),c(!1)}}),n=(a,x)=>{a.stopPropagation(),j({type:"DELETE",id:x}),c(!0)},w=(a,x)=>{a.stopPropagation(),j({type:"EDIT",client:x}),c(!0)},z=()=>{l&&(l.type==="DELETE"&&l.id?s.mutate(l.id):l.type==="EDIT"&&l.client&&(p(l.client),i(!0),c(!1)))},P=()=>{p(null),i(!0)},M=a=>{g(a),d(!0)};return N?e.jsx("div",{children:"Loading clients..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Clients"}),e.jsxs("button",{onClick:P,className:"bg-primary text-primary-foreground px-4 py-2 rounded-md font-medium text-sm flex items-center gap-2 hover:bg-primary/90 transition-colors",children:[e.jsx(J,{size:16}),"New Client"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Client Name"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Industry"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Campaigns"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:o==null?void 0:o.map(a=>{var x;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group cursor-pointer",onClick:()=>M(a),children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-3",children:[a.logo_url?e.jsx("img",{src:a.logo_url.startsWith("http")||a.logo_url.startsWith("blob:")?a.logo_url:`${"http://localhost:4001/api".replace("/api","")||"http://localhost:4000"}${a.logo_url}`,alt:a.name,className:"w-8 h-8 rounded-full object-cover border border-gray-200",onError:m=>{m.target.style.display="none"}}):e.jsx("div",{className:"p-2 bg-primary/10 rounded-full text-primary",children:e.jsx(T,{size:16})}),a.name]})}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:a.industry||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:a.status})}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:((x=a._count)==null?void 0:x.campaigns)||0}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 isolate z-10",children:[" ",e.jsx("button",{onClick:m=>w(m,a),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:e.jsx(K,{size:16})}),e.jsx("button",{onClick:m=>n(m,a.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:e.jsx(Z,{size:16})})]})})]},a.id)})})]}),(o==null?void 0:o.length)===0&&e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No clients found."})]}),e.jsx(R,{isOpen:t,onClose:()=>i(!1),clientToEdit:r}),e.jsx(X,{isOpen:y,onClose:()=>d(!1),client:b}),e.jsx(Y,{isOpen:v,onClose:()=>c(!1),onConfirm:z,title:(l==null?void 0:l.type)==="DELETE"?"Delete Client":"Edit Client",message:(l==null?void 0:l.type)==="DELETE"?"Are you sure you want to delete this client? This action cannot be undone.":"Do you want to edit details for this client?",type:(l==null?void 0:l.type)==="DELETE"?"danger":"info"})]})};export{ge as default};
