import{v as u,q as N,j as e,w as l}from"./index-W29iofZb.js";import{b as v,c as w,u as _,d as E,C as S,W as k,o as A,s as d,_ as C,z as P}from"./index-BJPAJU8j.js";import{f as m}from"./format-Cdl30bIy.js";/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=u("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=u("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),D=A({date:d(),description:d().min(3,"Description is required"),amount:P().min(1,"Amount must be positive"),type:C(["EXPENSE","INCOME"]),payment_mode_id:d().min(1,"Payment Mode is required"),category_id:d().min(1,"Ledger Account is required"),reference:d().optional()}),F=()=>{const p=N(),{register:n,handleSubmit:x,watch:y,reset:g,formState:{errors:t}}=v({resolver:w(D),defaultValues:{date:m(new Date,"yyyy-MM-dd"),type:"EXPENSE",amount:0}}),{data:r,isLoading:h}=_({queryKey:["ledgers"],queryFn:async()=>(await l.get("/accounting/ledgers")).data}),c=E({mutationFn:s=>l.post("/accounting/transactions",s),onSuccess:()=>{p.invalidateQueries({queryKey:["ledgers"]}),alert("Transaction Recorded Successfully!"),g({date:m(new Date,"yyyy-MM-dd"),type:"EXPENSE",amount:0,description:"",reference:""})},onError:s=>{var i,o;alert("Failed: "+(((o=(i=s.response)==null?void 0:i.data)==null?void 0:o.message)||s.message))}}),a=y("type")==="EXPENSE",f=(r==null?void 0:r.filter(s=>["BANK","CASH"].includes(s.entity_type)))||[],b=(r==null?void 0:r.filter(s=>!["BANK","CASH"].includes(s.entity_type)))||[],j=s=>{const i={date:s.date,description:s.description,amount:s.amount,type:s.type,reference:s.reference,from_ledger_id:a?s.payment_mode_id:s.category_id,to_ledger_id:a?s.category_id:s.payment_mode_id};c.mutate(i)};return h?e.jsx("div",{children:"Loading Ledgers..."}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Record Transaction"}),e.jsx("p",{className:"text-muted-foreground",children:"Single-entry mode: Record Income or Expenses."})]}),e.jsx("div",{className:"bg-card border rounded-lg p-6 shadow-sm",children:e.jsxs("form",{onSubmit:x(j),className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4 p-1 bg-muted rounded-lg",children:[e.jsxs("label",{className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-md cursor-pointer transition-all ${a?"bg-background shadow-sm text-red-600 font-medium":"text-muted-foreground"}`,children:[e.jsx("input",{type:"radio",value:"EXPENSE",...n("type"),className:"hidden"}),e.jsx(q,{className:"w-4 h-4"}),"Expense (Out)"]}),e.jsxs("label",{className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-md cursor-pointer transition-all ${a?"text-muted-foreground":"bg-background shadow-sm text-green-600 font-medium"}`,children:[e.jsx("input",{type:"radio",value:"INCOME",...n("type"),className:"hidden"}),e.jsx(M,{className:"w-4 h-4"}),"Income (In)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",className:"w-full bg-background border rounded-md px-3 py-2 pl-10",...n("date")}),e.jsx(S,{className:"w-4 h-4 absolute left-3 top-3 text-muted-foreground"})]}),t.date&&e.jsx("span",{className:"text-destructive text-xs",children:t.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Amount (","â‚¹",")"]}),e.jsx("input",{type:"number",step:"0.01",className:"w-full bg-background border rounded-md px-3 py-2 font-mono",...n("amount",{valueAsNumber:!0})}),t.amount&&e.jsx("span",{className:"text-destructive text-xs",children:t.amount.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("input",{type:"text",placeholder:a?"e.g. Paid Electricity Bill":"e.g. Received Client Payment",className:"w-full bg-background border rounded-md px-3 py-2",...n("description")}),t.description&&e.jsx("span",{className:"text-destructive text-xs",children:t.description.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),a?"Paid From (Source)":"Deposit To (Destination)"]}),e.jsxs("select",{className:"w-full bg-background border rounded-md px-3 py-2",...n("payment_mode_id"),children:[e.jsx("option",{value:"",children:"Select Bank / Cash"}),f.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.entity_type,")"]},s.id))]}),t.payment_mode_id&&e.jsx("span",{className:"text-destructive text-xs",children:t.payment_mode_id.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:a?"Expense Account":"Income Account"}),e.jsxs("select",{className:"w-full bg-background border rounded-md px-3 py-2",...n("category_id"),children:[e.jsx("option",{value:"",children:"Select Ledger Account"}),b.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.head.name,")"]},s.id))]}),t.category_id&&e.jsx("span",{className:"text-destructive text-xs",children:t.category_id.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Reference (Optional)"}),e.jsx("input",{type:"text",placeholder:"Cheque # / UPI Ref",className:"w-full bg-background border rounded-md px-3 py-2",...n("reference")})]}),e.jsx("button",{type:"submit",disabled:c.isPending,className:`w-full py-2 rounded-md font-medium text-white transition-colors disabled:opacity-50 ${a?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:c.isPending?"Processing...":a?"Record Expense":"Record Income"})]})})]})};export{F as default};
