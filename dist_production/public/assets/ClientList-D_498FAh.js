import{v as S,r as h,j as e,q as D,B as I,z as L,w as k}from"./index-CYovX-18.js";import{R as O,q as M,O as $,r as F,X as U,v as T,U as q,M as B,u as V,d as R,P as W,w as Q}from"./index-DG6laMbl.js";import{G as C,C as G}from"./ClientFormModal-CH-QHucO.js";import{B as _}from"./building-2-C7JxWd9d.js";import{T as J}from"./target-BoILNFZG.js";import{D as E}from"./dollar-sign-BdeFNfPA.js";import{B as K}from"./ImageUpload-CZXxhHEG.js";import{P as X}from"./phone-BxkSBUDU.js";import{P as Z}from"./pencil-DILtGXJ2.js";import"./FormErrorAlert-CXCprUnH.js";import"./alert-circle-V7EQjuNI.js";import"./building-D0HYo3ZX.js";import"./save-DIsemnYH.js";import"./loader-2-CtimSdx4.js";import"./upload-WY1TDvjd.js";/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=S("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Y=({isOpen:f,onClose:u,client:t})=>{var l,j,o,N;const[i,b]=h.useState("core");if(!t)return null;const d=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return null}return s},v=s=>s?s.startsWith("http")||s.startsWith("blob:")?s:`${"http://72.61.246.22:4001/api".replace("/api","")}${s}`:"",c=d(t.service_engagement)||[],r=d(t.social_links)||{},p=d(t.customer_avatar)||{},y=d(t.competitor_info)||[],m=({id:s,label:n,icon:w})=>e.jsxs("button",{onClick:()=>b(s),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors flex-shrink-0 ${i===s?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-200"}`,children:[e.jsx(w,{size:16}),n]});return e.jsx(O,{open:f,onOpenChange:u,children:e.jsx(M,{children:e.jsx($,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in transition-opacity",children:e.jsxs(F,{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col focus:outline-none relative animate-in zoom-in-95 duration-200",children:[e.jsx("button",{onClick:u,className:"absolute top-4 right-4 p-2 bg-gray-100 hover:bg-gray-200 text-gray-500 rounded-full transition-colors z-[60]",children:e.jsx(U,{size:20})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start mb-8",children:[e.jsxs("div",{className:"w-32 h-32 bg-white rounded-xl shadow-md p-2 flex items-center justify-center border border-gray-100 flex-shrink-0 relative overflow-hidden",children:[t.logo_url?e.jsx("img",{src:v(t.logo_url),alt:t.name,className:"w-full h-full object-contain",onError:s=>{var n;s.target.style.display="none",(n=s.target.nextElementSibling)==null||n.classList.remove("hidden")}}):e.jsx("div",{className:"w-full h-full bg-blue-50 rounded-lg flex items-center justify-center text-primary",children:e.jsx(_,{size:40})}),e.jsx("div",{className:"hidden absolute inset-0 bg-gray-50 flex items-center justify-center text-gray-400",children:e.jsx(_,{size:32})})]}),e.jsxs("div",{className:"flex-1 pt-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:t.industry||"Industry N/A"}),e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-bold ${t.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.status})]})]})]}),e.jsxs("div",{className:"flex border-b mb-6 overflow-x-auto flex-shrink-0",children:[e.jsx(m,{id:"core",label:"Core Info",icon:_}),e.jsx(m,{id:"services",label:"Services",icon:J}),e.jsx(m,{id:"team",label:"Team",icon:T}),e.jsx(m,{id:"ad_accounts",label:"Ad Accounts",icon:E}),e.jsx(m,{id:"extended",label:"Extended",icon:K}),e.jsx(m,{id:"strategy",label:"Strategy",icon:C})]}),e.jsxs("div",{className:"min-h-[300px]",children:[i==="core"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 animate-in fade-in",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Contact Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(q,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-sm",children:t.contact_person||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(B,{size:16,className:"text-gray-400"}),e.jsx("a",{href:`mailto:${t.company_email}`,className:"text-sm hover:text-primary hover:underline",children:t.company_email||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(X,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"text-sm",children:t.contact_number||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(C,{size:16,className:"text-gray-400"}),e.jsx("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",className:"text-sm hover:text-primary hover:underline",children:r.website||"N/A"})]}),e.jsxs("div",{className:"flex items-start gap-3 text-gray-700",children:[e.jsx(H,{size:16,className:"text-gray-400 mt-0.5"}),e.jsx("span",{className:"text-sm",children:t.address||"No address provided"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Account Manager"}),t.account_manager?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-700 font-bold text-sm",children:(l=t.account_manager.full_name)==null?void 0:l.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.account_manager.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.account_manager.email})]})]}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No account manager assigned."})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Assigned Execution Team"}),t.assigned_staff&&t.assigned_staff.length>0?e.jsx("div",{className:"space-y-2",children:t.assigned_staff.map(s=>{var n;return e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg border border-gray-100",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.full_name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-700 font-bold text-xs",children:(n=s.full_name)==null?void 0:n.charAt(0)}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.full_name})})]},s.id)})}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No execution team assigned."})]})]}),i==="services"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Engaged Services"}),c.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(s=>e.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm font-medium border border-blue-100",children:s},s))}):e.jsx("p",{className:"text-gray-500 italic text-sm",children:"No services listed."})]}),i==="team"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Assigned Team"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-md bg-purple-50/50",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-purple-700 font-bold text-xs",children:((o=(j=t.account_manager)==null?void 0:j.full_name)==null?void 0:o.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((N=t.account_manager)==null?void 0:N.full_name)||"Unassigned"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Account Manager"})]})]}),t.assigned_staff&&t.assigned_staff.length>0&&e.jsx(e.Fragment,{children:t.assigned_staff.map(s=>{var n;return e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-md bg-white hover:bg-gray-50 transition-colors",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.full_name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-700 font-bold text-xs",children:(n=s.full_name)==null?void 0:n.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Execution Team"})]})]},s.id)})})]})]}),i==="ad_accounts"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Linked Ad Accounts"}),t.ad_accounts&&t.ad_accounts.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.ad_accounts.map(s=>e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider bg-white border px-2 py-0.5 rounded text-gray-600",children:s.platform}),e.jsx("span",{className:`w-2 h-2 rounded-full ${s.status==="ACTIVE"?"bg-green-500":"bg-red-400"}`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs font-mono text-gray-500 mt-0.5",children:s.external_id})]})]},s.id))}):e.jsxs("div",{className:"text-center p-8 bg-gray-50 rounded-lg border border-dashed text-gray-400",children:[e.jsx(E,{size:24,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No ad accounts linked."})]})]}),i==="extended"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 animate-in fade-in",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Social Presence"}),e.jsxs("div",{className:"space-y-3",children:[r.facebook&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"Facebook:"})," ",e.jsx("a",{href:r.facebook,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.facebook})]}),r.instagram&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"Instagram:"})," ",e.jsx("a",{href:r.instagram,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.instagram})]}),r.linkedin&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"LinkedIn:"})," ",e.jsx("a",{href:r.linkedin,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.linkedin})]}),r.twitter&&e.jsxs("div",{className:"flex gap-2 text-sm items-center",children:[e.jsx("span",{className:"w-20 font-medium text-gray-600",children:"Twitter:"})," ",e.jsx("a",{href:r.twitter,target:"_blank",className:"text-blue-600 truncate hover:underline",children:r.twitter})]}),!r.facebook&&!r.instagram&&!r.linkedin&&!r.twitter&&e.jsx("p",{className:"text-gray-500 italic text-sm",children:"No social links configured."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Customer Avatar"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-800",children:p.description||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Pain Points"}),e.jsx("p",{className:"text-sm text-gray-800",children:p.pain_points||"N/A"})]})]})]})]}),i==="strategy"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Competitors"}),y.length>0?e.jsx("div",{className:"space-y-3",children:y.map((s,n)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:s.name}),s.website&&e.jsx("a",{href:s.website,target:"_blank",className:"text-xs text-blue-600 hover:underline",children:s.website})]},n))}):e.jsx("p",{className:"text-gray-500 italic text-sm",children:"No competitor info."})]})]})]})]})})})})},ee=({isOpen:f,onClose:u,onConfirm:t,title:i,message:b,type:d="danger"})=>f?e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-sm w-full p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:i}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:b}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md",children:"Cancel"}),e.jsx("button",{onClick:t,className:`px-4 py-2 text-sm font-medium text-white rounded-md ${d==="danger"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,children:"Confirm"})]})]})}):null,pe=()=>{const f=D(),u=I(),[t,i]=h.useState(!1),[b,d]=h.useState(!1),[v,c]=h.useState(!1),[r,p]=h.useState(null),[y,m]=h.useState(null),[l,j]=h.useState(null);L.useEffect(()=>{new URLSearchParams(u.search).get("action")==="new"&&(p(null),i(!0))},[u.search]);const{data:o,isLoading:N}=V({queryKey:["clients"],queryFn:async()=>{const{data:a}=await k.get("/clients");return a}}),s=R({mutationFn:async a=>{await k.delete(`/clients/${a}`)},onSuccess:()=>{f.invalidateQueries({queryKey:["clients"]}),c(!1)},onError:a=>{var x,g;alert("Failed to delete: "+(((g=(x=a.response)==null?void 0:x.data)==null?void 0:g.message)||a.message)),c(!1)}}),n=(a,x)=>{a.stopPropagation(),j({type:"DELETE",id:x}),c(!0)},w=(a,x)=>{a.stopPropagation(),j({type:"EDIT",client:x}),c(!0)},A=()=>{l&&(l.type==="DELETE"&&l.id?s.mutate(l.id):l.type==="EDIT"&&l.client&&(p(l.client),i(!0),c(!1)))},z=()=>{p(null),i(!0)},P=a=>{m(a),d(!0)};return N?e.jsx("div",{children:"Loading clients..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Clients"}),e.jsxs("button",{onClick:z,className:"bg-primary text-primary-foreground px-4 py-2 rounded-md font-medium text-sm flex items-center gap-2 hover:bg-primary/90 transition-colors",children:[e.jsx(W,{size:16}),"New Client"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Client Name"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Industry"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700",children:"Campaigns"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-gray-700 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:o==null?void 0:o.map(a=>{var x;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group cursor-pointer",onClick:()=>P(a),children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-3",children:[a.logo_url?e.jsx("img",{src:a.logo_url.startsWith("http")||a.logo_url.startsWith("blob:")?a.logo_url:`${"http://72.61.246.22:4001/api".replace("/api","")||"http://localhost:4000"}${a.logo_url}`,alt:a.name,className:"w-8 h-8 rounded-full object-cover border border-gray-200",onError:g=>{g.target.style.display="none"}}):e.jsx("div",{className:"p-2 bg-primary/10 rounded-full text-primary",children:e.jsx(T,{size:16})}),a.name]})}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:a.industry||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:a.status})}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:((x=a._count)==null?void 0:x.campaigns)||0}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 isolate z-10",children:[" ",e.jsx("button",{onClick:g=>w(g,a),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit",children:e.jsx(Z,{size:16})}),e.jsx("button",{onClick:g=>n(g,a.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:e.jsx(Q,{size:16})})]})})]},a.id)})})]}),(o==null?void 0:o.length)===0&&e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No clients found."})]}),e.jsx(G,{isOpen:t,onClose:()=>i(!1),clientToEdit:r}),e.jsx(Y,{isOpen:b,onClose:()=>d(!1),client:y}),e.jsx(ee,{isOpen:v,onClose:()=>c(!1),onConfirm:A,title:(l==null?void 0:l.type)==="DELETE"?"Delete Client":"Edit Client",message:(l==null?void 0:l.type)==="DELETE"?"Are you sure you want to delete this client? This action cannot be undone.":"Do you want to edit details for this client?",type:(l==null?void 0:l.type)==="DELETE"?"danger":"info"})]})};export{pe as default};
