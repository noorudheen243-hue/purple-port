import{r as d,j as e,H as x,w as c}from"./index-CYovX-18.js";import{d as u}from"./index-DG6laMbl.js";import{D as g}from"./download-B23IOqDP.js";import{U as h}from"./upload-WY1TDvjd.js";const y=()=>{const[l,i]=d.useState(null),[n,a]=d.useState(""),m=async()=>{try{a("Downloading export...");const t=await c.get("/backup/export-json",{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=r,s.setAttribute("download",`purple-port-backup-${new Date().toISOString().split("T")[0]}.zip`),document.body.appendChild(s),s.click(),s.remove(),a("Export Complete!")}catch(t){console.error(t),a("Export Failed")}},o=u({mutationFn:async t=>await c.post("/backup/import-json",t,{headers:{"Content-Type":"multipart/form-data"}}),onSuccess:()=>{a("SUCCESS: Data Restored! Please refresh the page."),i(null),setTimeout(()=>window.location.reload(),2e3)},onError:t=>{a(`Error: ${t.message||"Import failed"}`)}}),p=()=>{if(!l||!window.confirm("WARNING: This will DELETE all existing data on this server and replace it with the file data. Are you sure?"))return;const t=new FormData;t.append("file",l),a("Restoring data... This may take a minute..."),o.mutate(t)};return e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Synchronization"}),e.jsx("p",{className:"text-gray-600",children:"Sync data between your Local Application and the Online Server."}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(g,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Export Data"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Download all current database records (Users, Clients, Tasks, etc.) as a JSON file."}),e.jsx("button",{onClick:m,className:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition",children:"Download Backup (.json)"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow border border-red-50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(h,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Import Data"})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded border border-red-100 mb-4 flex gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsxs("p",{className:"text-xs text-red-800",children:[e.jsx("strong",{children:"Warning:"})," Importing will Permanently DELETE existing data on this server and replace it."]})]}),e.jsx("input",{type:"file",accept:".zip,.json",onChange:t=>{var r;return i(((r=t.target.files)==null?void 0:r[0])||null)},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100 mb-4"}),e.jsx("button",{onClick:p,disabled:!l||o.isPending,className:"w-full py-2 px-4 bg-red-600 hover:bg-red-700 disabled:bg-gray-300 text-white rounded-lg transition",children:o.isPending?"Restoring...":"Restore Data"})]})]}),n&&e.jsx("div",{className:`p-4 rounded-lg text-center font-medium ${n.includes("SUCCESS")?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:n})]})};export{y as default};
