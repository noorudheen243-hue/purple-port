import{q as je,u as Ne,r as h,x as I,j as e}from"./index-DTs_gUpQ.js";import{a2 as ve,a5 as _e,u as $,a3 as P,j as Ae,S as Ce,X as te,U as ne,aE as Se,P as G,m as V,ah as Ee,a7 as b,aF as A,a8 as i,a9 as F,ak as we,aa as Ie,an as re}from"./index-BPHe9uWR.js";import{B as De,I as ke}from"./ImageUpload-C96R0Et1.js";import{F as Me}from"./FormErrorAlert-BQq0KVhK.js";import{B as Le}from"./building-Cn2qDfL_.js";import{T as Be}from"./target-CKnOdLgG.js";import{D as K}from"./dollar-sign-wki1gni7.js";import{G as ie}from"./globe-kndGuocV.js";import{P as Pe}from"./pen-RIYTbplT.js";import{S as Ge}from"./save-dY_yXBe1.js";const Ve=b({name:i().min(2,"Name must be at least 2 characters"),industry:i().optional(),status:F(["LEAD","ACTIVE","ON_HOLD","COMPLETED","INACTIVE"]).default("LEAD"),brand_colors:i().optional(),logo_url:i().optional(),contact_person:i().optional(),contact_number:i().optional(),company_email:i().email("Invalid email").optional().or(re("")),address:i().optional(),operating_locations:A(b({country:i().min(1,"Country required"),state:i().optional()})).default([]),account_manager_id:i().optional().or(re("")),assigned_staff_ids:A(i()).default([]),service_engagement:A(i()).default([]),ad_accounts:A(b({id:i().optional(),platform:F(["GOOGLE","META","LINKEDIN","TIKTOK","OTHER"]).default("META"),name:i().min(1,"Account Name Required"),external_id:i().min(1,"Account ID Required"),status:F(["ACTIVE","INACTIVE"]).default("ACTIVE")})).default([]),social_links:b({website:i().optional(),facebook:i().optional(),instagram:i().optional(),linkedin:i().optional(),twitter:i().optional()}).optional(),competitor_info:A(b({name:i(),website:i().optional()})).default([]),customer_avatar:b({description:i().optional(),pain_points:i().optional()}).optional(),content_strategies:A(b({type:i(),quantity:Ie().min(0)})).default([]),ledger_options:b({create:we(),head_id:i().optional()}).optional()}),Te=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Comoros","Congo (Congo-Brazzaville)","Costa Rica","Croatia","Cuba","Cyprus","Czechia (Czech Republic)","Democratic Republic of the Congo","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini (fmr. 'Swaziland')","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Holy See","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar (formerly Burma)","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","North Macedonia","Norway","Oman","Pakistan","Palau","Palestine State","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States of America","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],ze=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],Oe=({clientToEdit:m})=>{const{data:f,isLoading:r}=$({queryKey:["next-client-code"],queryFn:async()=>(await I.get("/clients/next-code")).data,enabled:!m,staleTime:0}),D=m?m.client_code:r?"Loading...":(f==null?void 0:f.code)||"Auto-Generated";return e.jsxs("div",{className:"relative",children:[e.jsx("input",{value:D,disabled:!0,className:"input bg-gray-100 text-gray-600 font-mono font-bold"}),!m&&e.jsx("span",{className:"absolute right-3 top-2.5 text-[10px] text-gray-400",children:"PREVIEW"})]})},Ye=({isOpen:m,onClose:f,clientToEdit:r,onSuccess:D})=>{var Z,ee;const k=je(),{user:t}=Ne(),[y,C]=h.useState(0),M=["core","services","team","ad_accounts","finance","extended","strategy"],j=M[y],{register:l,control:S,handleSubmit:le,reset:E,watch:u,setValue:L,trigger:Re,formState:{errors:d,isSubmitting:H}}=ve({resolver:_e(Ve),mode:"onChange",defaultValues:{name:"",status:"LEAD",service_engagement:[],assigned_staff_ids:[],ad_accounts:[],competitor_info:[],social_links:{},operating_locations:[],customer_avatar:{description:"",pain_points:""},content_strategies:[],address:"",ledger_options:{create:!1,head_id:""}}}),oe=async()=>{y<M.length-1&&C(a=>a+1)},de=()=>{y>0&&C(a=>a-1)},[q,U]=h.useState(!1),[v,T]=h.useState(!1),[z,O]=h.useState("");h.useEffect(()=>{var a;T(r?!!((a=r.ledger_options)!=null&&a.create):!1)},[r,E,m]);const[R,ce]=h.useState(""),{data:p}=$({queryKey:["staff"],queryFn:async()=>(await I.get("/team/staff")).data,enabled:!!m}),{data:_}=$({queryKey:["accountHeads"],queryFn:async()=>(await I.get("/accounting/heads")).data,enabled:!!m});h.useEffect(()=>{m||O("")},[m]),h.useEffect(()=>{var a;if((a=r==null?void 0:r.ledger_options)!=null&&a.head_id&&_){const s=_.find(n=>n.id===r.ledger_options.head_id);s&&s.type&&O(s.type)}},[r,_]);const{fields:W,append:me,remove:ue}=P({control:S,name:"competitor_info"}),{fields:X,append:Q,remove:pe}=P({control:S,name:"ad_accounts"}),{fields:xe,append:he,remove:ge}=P({control:S,name:"content_strategies"}),{fields:J,append:Y,remove:be}=P({control:S,name:"operating_locations"});h.useEffect(()=>{var a,s,n;if(r){const x=w(r.service_engagement,[]).map(o=>o==="Meta Ads"?"META_ADS":o==="Google Ads"?"GOOGLE_ADS":o==="SEO"?"SEO":o==="Web Development"||o==="Web Design / Development"?"WEB_DEV":o==="Graphic Design"?"GRAPHIC_DESIGN":o==="Content Creation"||o==="Content Creation & Page Handling"?"CONTENT":o==="Branding"||o==="Branding & Logo Design"?"BRANDING":o==="Video Production"?"VIDEO_PROD":o==="Video Editing"?"VIDEO_EDIT":o);E({name:r.name,industry:r.industry||"",status:r.status,logo_url:r.logo_url||"",contact_person:r.contact_person||"",contact_number:r.contact_number||"",company_email:r.company_email||"",account_manager_id:r.account_manager_id||"",assigned_staff_ids:((a=r.assigned_staff)==null?void 0:a.map(o=>o.id))||[],ad_accounts:r.ad_accounts||[],service_engagement:x,social_links:w(r.social_links,{}),competitor_info:w(r.competitor_info,[]),customer_avatar:w(r.customer_avatar,{description:"",pain_points:""}),content_strategies:r.content_strategies||[],operating_locations:w(r.operating_locations_json,[]),address:r.address||"",ledger_options:{create:((s=r.ledger_options)==null?void 0:s.create)||!1,head_id:((n=r.ledger_options)==null?void 0:n.head_id)||""}})}else E({name:"",status:"LEAD",service_engagement:[],assigned_staff_ids:[],ad_accounts:[],competitor_info:[],social_links:{},customer_avatar:{description:"",pain_points:""},content_strategies:[]})},[r,E,m]);const w=(a,s)=>{if(typeof a=="string")try{return JSON.parse(a)}catch{return s}return a||s},fe=Ae({mutationFn:async a=>r?await I.patch(`/clients/${r.id}`,a):await I.post("/clients",a),onSuccess:a=>{k.invalidateQueries({queryKey:["clients"]}),k.invalidateQueries({queryKey:["client"]}),k.invalidateQueries({queryKey:["clients-list-simple"]}),k.invalidateQueries({queryKey:["client-portal-dashboard"]}),D&&D(a.data),f(),E(),C(0),Ce.fire({title:"Success!",text:r?"Client profile updated successfully.":"New client added successfully.",icon:"success",confirmButtonColor:"#8b5cf6",timer:2e3,timerProgressBar:!0})},onError:a=>{var s,n;console.error("Mutation Error:",a),alert("Failed: "+(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.message)||a.message))}});h.useEffect(()=>{m&&C(0)},[m]);const N=({id:a,label:s,icon:n,index:c})=>{const x=c===y;return e.jsxs("button",{type:"button",onClick:()=>C(c),className:`flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors cursor-pointer hover:bg-gray-100 min-w-max ${x?"border-primary text-primary":"border-transparent text-gray-400"}`,children:[e.jsx(n,{size:16}),s]})},ye=a=>{const s={...a,account_manager_id:a.account_manager_id||void 0,logo_url:a.logo_url||void 0,industry:a.industry||void 0,contact_person:a.contact_person||void 0,contact_number:a.contact_number||void 0,company_email:a.company_email||void 0,address:a.address||void 0};fe.mutate(s)};return m?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Edit Client":"Add New Client"}),e.jsx("button",{onClick:f,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(te,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"flex border-b px-4 overflow-x-auto bg-gray-50/50",children:[e.jsx(N,{id:"core",label:"Core Info",icon:Le,index:0}),e.jsx(N,{id:"services",label:"Services",icon:Be,index:1}),e.jsx(N,{id:"team",label:"Team",icon:ne,index:2}),e.jsx(N,{id:"ad_accounts",label:"Ad Accounts",icon:K,index:3}),e.jsx(N,{id:"finance",label:"Finance",icon:K,index:4}),e.jsx(N,{id:"extended",label:"Extended",icon:De,index:5}),e.jsx(N,{id:"strategy",label:"Strategy",icon:ie,index:6})]}),e.jsxs("form",{className:"flex-1 overflow-y-auto p-6",children:[j==="core"&&e.jsx("div",{className:"space-y-6 animate-in fade-in",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Name *"}),e.jsx("input",{...l("name"),className:`input ${d.name?"border-red-500":""}`,placeholder:"Acme Corp",autoFocus:!0}),d.name&&e.jsx("p",{className:"error",children:d.name.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Client ID ",r?"":"(Auto-Generated)"]}),e.jsx(Oe,{clientToEdit:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Industry"}),e.jsx("input",{...l("industry"),className:"input",placeholder:"Software, Retail, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{...l("status"),className:"input",children:[e.jsx("option",{value:"LEAD",children:"Lead"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"ON_HOLD",children:"On Hold"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"label",children:"Client Logo"}),e.jsx(Se,{control:S,name:"logo_url",render:({field:a})=>e.jsx(ke,{label:"",value:a.value,onChange:a.onChange})}),d.logo_url&&e.jsx("p",{className:"error",children:d.logo_url.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 border-b pb-2",children:"Primary Contact"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact Person"}),e.jsx("input",{...l("contact_person"),className:"input",placeholder:"Full Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email Address"}),e.jsx("input",{...l("company_email"),className:`input ${d.company_email?"border-red-500":""}`,placeholder:"email@company.com"}),d.company_email&&e.jsx("p",{className:"error",children:d.company_email.message})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label",children:"Mobile Number"}),e.jsx("input",{...l("contact_number"),className:"input",placeholder:"+1 234..."})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"label",children:"Business Address"}),e.jsx("textarea",{...l("address"),className:"input min-h-[60px]",placeholder:"Full street address..."})]}),e.jsxs("div",{className:"flex justify-between items-center border-b pb-2 mt-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Operating Locations"}),e.jsxs("button",{type:"button",onClick:()=>Y({country:"",state:""}),className:"text-xs text-primary flex items-center gap-1 hover:underline",children:[e.jsx(G,{size:12})," Add Location"]})]}),e.jsxs("div",{className:"space-y-3 mt-3",children:[J.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-[1fr,1fr,auto] gap-3 items-end bg-gray-50 p-2 rounded relative group animate-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Country"}),e.jsxs("select",{...l(`operating_locations.${s}.country`),className:"input text-sm py-1.5 h-9",children:[e.jsx("option",{value:"",children:"Select..."}),Te.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),u(`operating_locations.${s}.country`)==="India"?e.jsxs("div",{className:"space-y-1 animate-in fade-in",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500",children:"State"}),e.jsxs("select",{...l(`operating_locations.${s}.state`),className:"input text-sm py-1.5 h-9",children:[e.jsx("option",{value:"",children:"Select..."}),ze.map(n=>e.jsx("option",{value:n,children:n},n))]})]}):e.jsxs("div",{className:"space-y-1 opacity-50 pointer-events-none",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500",children:"State"}),e.jsx("input",{disabled:!0,className:"input text-sm py-1.5 h-9 bg-gray-100",placeholder:"N/A"})]}),e.jsx("button",{type:"button",onClick:()=>be(s),className:"text-gray-400 hover:text-red-500 p-2 hover:bg-gray-100 rounded-lg mb-0.5",children:e.jsx(V,{size:16})})]},a.id)),J.length===0&&e.jsxs("div",{className:"text-center p-4 border-2 border-dashed rounded text-sm text-gray-400",children:["No locations added. ",e.jsx("button",{type:"button",onClick:()=>Y({country:"",state:""}),className:"text-primary hover:underline",children:"Add Primary Location"})]})]})]})]})}),j==="services"&&e.jsx("div",{className:"space-y-6 animate-in fade-in",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Service Engagement"}),e.jsx("div",{className:"space-y-3",children:[{id:"META_ADS",label:"Meta Ads"},{id:"GOOGLE_ADS",label:"Google Ads"},{id:"SEO",label:"SEO"},{id:"WEB_DEV",label:"Web Design / Development"},{id:"GRAPHIC_DESIGN",label:"Graphic Design"},{id:"CONTENT",label:"Content Creation"},{id:"BRANDING",label:"Branding"},{id:"VIDEO_PROD",label:"Video Production"},{id:"VIDEO_EDIT",label:"Video Editing"}].map(a=>{const s=u("service_engagement").includes(a.id);return e.jsxs("div",{className:`flex items-center justify-between p-4 border rounded-lg transition-all ${s?"bg-green-50 border-green-200 shadow-sm":"bg-white hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s?"bg-green-500 shadow-sm shadow-green-200":"bg-gray-300"}`}),e.jsx("span",{className:`font-medium ${s?"text-green-900":"text-gray-700"}`,children:a.label})]}),e.jsx("button",{type:"button",onClick:()=>{const n=u("service_engagement");s?L("service_engagement",n.filter(c=>c!==a.id)):L("service_engagement",[...n,a.id])},className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${s?"bg-white border border-red-200 text-red-600 hover:bg-red-50":"bg-primary text-primary-foreground hover:bg-primary/90"}`,children:s?"Deactivate":"Activate"})]},a.id)})})]})}),j==="team"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in max-w-2xl pb-64",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account Manager (Lead)"}),e.jsxs("select",{...l("account_manager_id"),className:`input ${d.account_manager_id?"border-red-500":""}`,children:[e.jsx("option",{value:"",children:"Select Manager..."}),p==null?void 0:p.sort((a,s)=>{var n,c;return(c=a.user)==null?void 0:c.full_name.localeCompare((n=s.user)==null?void 0:n.full_name)}).filter(a=>{var s,n,c,x,o,g;return(a.department==="MANAGEMENT"||a.department==="MARKETING"||a.department==="WEB"||((s=a.user)==null?void 0:s.role)==="ADMIN"||((n=a.user)==null?void 0:n.role)==="MANAGER"||((c=a.user)==null?void 0:c.role)==="DEVELOPER_ADMIN"||((x=a.user)==null?void 0:x.role)==="DM_EXECUTIVE"||((o=a.user)==null?void 0:o.role)==="WEB_SEO_EXECUTIVE"||((g=a.user)==null?void 0:g.role)==="MARKETING_EXEC")&&a.payroll_status==="ACTIVE"}).map(a=>{var s,n;return e.jsxs("option",{value:a.user_id,children:[(s=a.user)==null?void 0:s.full_name," (",(n=a.user)==null?void 0:n.role,")"]},a.id)})]}),d.account_manager_id&&e.jsx("p",{className:"error",children:d.account_manager_id.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Responsible for overall client relationship."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assigned Staff (Execution Team)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"input text-left flex justify-between items-center bg-white min-h-[42px]",onClick:()=>U(!q),disabled:(t==null?void 0:t.role)!=="ADMIN"&&(t==null?void 0:t.role)!=="MANAGER"&&(t==null?void 0:t.role)!=="DEVELOPER_ADMIN"&&(t==null?void 0:t.role)!=="DM_EXECUTIVE"&&(t==null?void 0:t.role)!=="WEB_SEO_EXECUTIVE"&&(t==null?void 0:t.role)!=="MARKETING_EXEC",children:[e.jsx("span",{className:"text-sm truncate",children:u("assigned_staff_ids").length===0?e.jsx("span",{className:"text-gray-400",children:"Select execution team..."}):`${u("assigned_staff_ids").length} Member${u("assigned_staff_ids").length>1?"s":""} Selected`}),e.jsx(ne,{size:16,className:"text-gray-400 flex-shrink-0"})]}),q&&((t==null?void 0:t.role)==="ADMIN"||(t==null?void 0:t.role)==="MANAGER"||(t==null?void 0:t.role)==="DEVELOPER_ADMIN"||(t==null?void 0:t.role)==="DM_EXECUTIVE"||(t==null?void 0:t.role)==="WEB_SEO_EXECUTIVE"||(t==null?void 0:t.role)==="MARKETING_EXEC")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>U(!1)}),e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border rounded-md shadow-lg z-20 max-h-60 overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100",children:[e.jsx("div",{className:"p-2 border-b bg-gray-50",children:e.jsx("input",{type:"text",placeholder:"Search by name or dept...",className:"w-full text-xs p-2 border rounded focus:outline-none focus:border-primary",value:R,onChange:a=>ce(a.target.value),autoFocus:!0})}),e.jsxs("div",{className:"overflow-y-auto p-1 max-h-48",children:[p==null?void 0:p.filter(a=>a.user&&a.payroll_status==="ACTIVE").filter(a=>a.user.full_name.toLowerCase().includes(R.toLowerCase())||a.department.toLowerCase().includes(R.toLowerCase())).map(a=>{var n;const s=u("assigned_staff_ids").includes(a.user_id);return e.jsxs("label",{className:`flex items-center gap-2 px-2 py-2 cursor-pointer hover:bg-gray-50 rounded text-sm group ${s?"bg-blue-50":""}`,children:[e.jsx("input",{type:"checkbox",value:a.user_id,...l("assigned_staff_ids"),className:"w-4 h-4 rounded text-primary focus:ring-primary accent-primary"}),e.jsxs("div",{className:"flex-1 flex justify-between items-center",children:[e.jsx("span",{className:`font-medium ${s?"text-primary":"text-gray-700"}`,children:(n=a.user)==null?void 0:n.full_name}),e.jsx("span",{className:"text-[10px] uppercase bg-gray-100 px-1.5 py-0.5 rounded text-gray-500",children:a.department})]})]},a.id)}),(p==null?void 0:p.length)===0&&e.jsx("p",{className:"text-xs text-center p-4 text-gray-400",children:"No staff found."})]})]})]})]}),u("assigned_staff_ids").length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3 p-2 bg-gray-50/50 rounded-md border border-dashed",children:u("assigned_staff_ids").map(a=>{var n,c,x,o;const s=p==null?void 0:p.find(g=>g.user_id===a);return s?e.jsxs("span",{className:"inline-flex items-center gap-1.5 bg-white border px-2 py-1 rounded-full text-xs shadow-sm group hover:border-red-200 hover:bg-red-50 transition-colors",children:[(n=s.user)!=null&&n.avatar_url?e.jsx("img",{src:s.user.avatar_url,className:"w-4 h-4 rounded-full object-cover"}):e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-100 flex items-center justify-center text-[8px] font-bold text-gray-600",children:(x=(c=s.user)==null?void 0:c.full_name)==null?void 0:x.charAt(0)}),e.jsx("span",{className:"font-medium text-gray-700 group-hover:text-red-600",children:(o=s.user)==null?void 0:o.full_name}),((t==null?void 0:t.role)==="ADMIN"||(t==null?void 0:t.role)==="DEVELOPER_ADMIN")&&e.jsx("button",{type:"button",onClick:()=>{const g=u("assigned_staff_ids");L("assigned_staff_ids",g.filter(B=>B!==a))},className:"ml-1 text-gray-400 hover:text-red-500 rounded-full p-0.5",children:e.jsx(te,{size:12})})]},a):null})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"These users will see task suggestions for this client."})]})]}),j==="ad_accounts"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Linked Ad Accounts"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Connect client ad accounts for Campaign Manager syncing."})]}),e.jsxs("button",{type:"button",onClick:()=>Q({platform:"META",name:"",external_id:"",status:"ACTIVE"}),className:"text-sm bg-primary/10 text-primary px-3 py-1.5 rounded-md flex items-center gap-1 hover:bg-primary/20 transition-colors",children:[e.jsx(G,{size:14})," Add Account"]})]}),e.jsxs("div",{className:"space-y-3",children:[X.map((a,s)=>{var n,c,x,o,g,B,ae,se;return e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 items-start bg-gray-50 p-3 rounded-md border border-gray-100 animate-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"w-full md:w-32",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 block",children:"Platform"}),e.jsxs("select",{...l(`ad_accounts.${s}.platform`),className:"input text-sm py-1.5",children:[e.jsx("option",{value:"META",children:"Meta (FB)"}),e.jsx("option",{value:"GOOGLE",children:"Google Ads"}),e.jsx("option",{value:"LINKEDIN",children:"LinkedIn"}),e.jsx("option",{value:"TIKTOK",children:"TikTok"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 block",children:"Account Name"}),e.jsx("input",{...l(`ad_accounts.${s}.name`),className:"input text-sm py-1.5",placeholder:"e.g. Qix Ads - Q1"}),((c=(n=d.ad_accounts)==null?void 0:n[s])==null?void 0:c.name)&&e.jsx("p",{className:"error",children:(o=(x=d.ad_accounts[s])==null?void 0:x.name)==null?void 0:o.message})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 block",children:"Account ID"}),e.jsx("input",{...l(`ad_accounts.${s}.external_id`),className:"input text-sm py-1.5 font-mono",placeholder:"e.g. act_123456789"}),((B=(g=d.ad_accounts)==null?void 0:g[s])==null?void 0:B.external_id)&&e.jsx("p",{className:"error",children:(se=(ae=d.ad_accounts[s])==null?void 0:ae.external_id)==null?void 0:se.message})]}),e.jsx("div",{className:"w-full md:w-auto flex justify-end mt-4 md:mt-0",children:e.jsx("button",{type:"button",onClick:()=>pe(s),className:"text-red-500 hover:text-red-700 p-2 bg-white rounded border border-gray-200 hover:bg-red-50 transition-colors",title:"Remove Account",children:e.jsx(V,{size:16})})})]},a.id)}),X.length===0&&e.jsxs("div",{className:"p-8 text-center border-2 border-dashed border-gray-200 rounded-lg",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-3 text-gray-300",children:e.jsx(K,{size:24})}),e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"No ad accounts linked."}),e.jsx("button",{type:"button",onClick:()=>Q({platform:"META",name:"",external_id:"",status:"ACTIVE"}),className:"text-xs text-primary hover:underline font-medium",children:"Click to add one"})]})]})]}),j==="finance"&&e.jsx("div",{className:"space-y-6 animate-in fade-in",children:e.jsxs("div",{className:"p-4 bg-gray-50 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"checkbox",...l("ledger_options.create"),className:"w-5 h-5 rounded text-primary focus:ring-primary accent-primary",id:"create_ledger"}),e.jsx("label",{htmlFor:"create_ledger",className:"font-medium text-gray-900 cursor-pointer select-none",children:"Create a dedicated Ledger Account for this client?"})]}),u("ledger_options.create")&&e.jsxs("div",{className:"pl-7 space-y-4 animate-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["A new ledger will be created named ",e.jsx("strong",{children:u("name")||"Client Name"}),". Please select the parent Account Head (Category)."]}),v&&e.jsxs("button",{type:"button",onClick:()=>T(!1),className:"text-xs flex items-center gap-1 text-blue-600 hover:text-blue-700 bg-blue-50 px-2 py-1 rounded border border-blue-100 transition-colors",children:[e.jsx(Pe,{size:12})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:v?"opacity-60 pointer-events-none grayscale":"",children:[e.jsx("label",{className:"label",children:"Account Type"}),e.jsxs("select",{className:"input",value:z,disabled:v,onChange:a=>{O(a.target.value),L("ledger_options.head_id","")},children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"ASSET",children:"Assets (debtors)"}),e.jsx("option",{value:"LIABILITY",children:"Liabilities"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Filter the list of Account Heads."})]}),e.jsxs("div",{className:v?"opacity-60 pointer-events-none grayscale":"",children:[e.jsx("label",{className:"label",children:"Account Head *"}),e.jsxs("select",{...l("ledger_options.head_id"),className:`input ${(Z=d.ledger_options)!=null&&Z.head_id?"border-red-500":""}`,disabled:v,children:[e.jsx("option",{value:"",children:"Select Head..."}),_==null?void 0:_.filter(a=>!z||a.type===z).map(a=>e.jsxs("option",{value:a.id,children:[a.name," (",a.code,")"]},a.id))]}),v&&e.jsxs("p",{className:"text-[10px] text-green-600 mt-1 flex items-center gap-1",children:[e.jsx(Ee,{size:8})," Linked to active ledger"]}),((ee=d.ledger_options)==null?void 0:ee.head_id)&&e.jsx("p",{className:"error",children:d.ledger_options.head_id.message})]})]})]}),!u("ledger_options.create")&&e.jsx("p",{className:"text-xs text-gray-400 pl-7",children:"Note: If skipped, a default Ledger (Income - 4000) might be reused or auto-created depending on system settings."})]})}),j==="extended"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium border-b pb-2",children:"Social Presence"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"label",children:"Website"}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{...l("social_links.website"),className:"input pl-9",placeholder:"https://"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"label",children:"Facebook"}),e.jsx("input",{...l("social_links.facebook"),className:"input",placeholder:"https://facebook.com/..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"label",children:"Instagram"}),e.jsx("input",{...l("social_links.instagram"),className:"input",placeholder:"https://instagram.com/..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"label",children:"LinkedIn"}),e.jsx("input",{...l("social_links.linkedin"),className:"input",placeholder:"https://linkedin.com/..."})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium border-b pb-2",children:"Customer Avatar"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description / Demographics"}),e.jsx("textarea",{...l("customer_avatar.description"),className:"input min-h-[80px]",placeholder:"Who is the ideal customer?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Pain Points"}),e.jsx("textarea",{...l("customer_avatar.pain_points"),className:"input min-h-[80px]",placeholder:"What problems do they face?"})]})]})]}),j==="strategy"&&e.jsxs("div",{className:"animate-in fade-in space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3 border-b pb-2",children:"Content Strategy (Monthly Commitments)"}),e.jsxs("div",{className:"space-y-3",children:[xe.map((a,s)=>e.jsxs("div",{className:"flex gap-3 items-center bg-gray-50 p-3 rounded-md border border-gray-100",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 block",children:"Content Type"}),e.jsxs("select",{...l(`content_strategies.${s}.type`),className:"input text-sm py-1.5",children:[e.jsx("option",{value:"Poster Design",children:"Poster Design"}),e.jsx("option",{value:"Reel Video",children:"Reel Video"}),e.jsx("option",{value:"Motion Graphic Video",children:"Motion Graphic Video"}),e.jsx("option",{value:"AI Video",children:"AI Video"}),e.jsx("option",{value:"Anchor Ads",children:"Anchor Ads"}),e.jsx("option",{value:"Carousel",children:"Carousel"}),e.jsx("option",{value:"Logo Design",children:"Logo Design"}),e.jsx("option",{value:"Brochure Design",children:"Brochure Design"}),e.jsx("option",{value:"Flyer Design",children:"Flyer Design"}),e.jsx("option",{value:"Flex / Billboard Design",children:"Flex / Billboard Design"}),e.jsx("option",{value:"Business Card",children:"Business Card"}),e.jsx("option",{value:"Letter Head",children:"Letter Head"})]})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 mb-1 block",children:"Quantity"}),e.jsx("input",{type:"number",...l(`content_strategies.${s}.quantity`,{valueAsNumber:!0}),className:"input text-sm py-1.5",min:0})]}),e.jsx("button",{type:"button",onClick:()=>ge(s),className:"text-red-500 hover:text-red-700 p-2 mt-4 bg-white rounded border border-gray-200",children:e.jsx(V,{size:16})})]},a.id)),e.jsxs("button",{type:"button",onClick:()=>he({type:"Poster Design",quantity:0}),className:"text-sm bg-primary/10 text-primary px-3 py-1.5 rounded-md flex items-center gap-1 hover:bg-primary/20 transition-colors",children:[e.jsx(G,{size:14})," Add Content Type"]})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"font-medium",children:"Competitor Analysis"}),e.jsxs("button",{type:"button",onClick:()=>me({name:"",website:""}),className:"text-sm text-primary flex items-center gap-1 hover:underline",children:[e.jsx(G,{size:14})," Add Competitor"]})]}),e.jsxs("div",{className:"space-y-3",children:[W.map((a,s)=>e.jsxs("div",{className:"flex gap-3 items-start bg-gray-50 p-3 rounded-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{...l(`competitor_info.${s}.name`),className:"input mb-2",placeholder:"Competitor Name"}),e.jsx("input",{...l(`competitor_info.${s}.website`),className:"input",placeholder:"Competitor Website"})]}),e.jsx("button",{type:"button",onClick:()=>ue(s),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(V,{size:16})})]},a.id)),W.length===0&&e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No competitors added."})]})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[y>0&&e.jsx("button",{type:"button",onClick:de,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md transition-colors",children:"Back"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Step ",y+1," of ",M.length]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md",children:"Cancel"}),e.jsxs("button",{onClick:le(ye,a=>{console.error("Form Validation Errors:",a)}),disabled:H,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium bg-green-600 text-white hover:bg-green-700 rounded-md disabled:opacity-50 shadow-sm transition-colors",children:[e.jsx(Ge,{size:16}),H?"Saving...":"Save"]}),y<M.length-1&&e.jsx("button",{type:"button",onClick:oe,className:"px-6 py-2 text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 rounded-md shadow-sm transition-colors",children:"Next"})]}),e.jsx("div",{className:"w-full max-w-md",children:e.jsx(Me,{errors:d})})]})]})]}),e.jsx("style",{children:`
                .label { display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem; }
                .input { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem; }
                .input:focus { outline: none; border-color: #3b82f6; ring: 2px solid #93c5fd; }
                .error { font-size: 0.75rem; color: #ef4444; margin-top: 0.25rem; }
            `})]}):null};export{Ye as C};
