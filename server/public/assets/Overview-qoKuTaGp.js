import{v as J,r as u,j as e,E as Z,x as b,u as O,a as G,J as ee,N as se}from"./index-DTs_gUpQ.js";import{D as F,a as B,u as A,T as K,C as W,U as q,b as te,c as ae,d as le,e as re,f as ne,g as z,h as ie,F as de,B as D,X as ce,i as oe,R as _}from"./index-BPHe9uWR.js";import{C as xe}from"./check-circle-CR2qGfs6.js";import{X as me}from"./x-circle-CrK1gkGM.js";import{L as he}from"./loader-2-DDF5548V.js";import{S as U}from"./server-Bao7YC6P.js";import{T as w,a as v,b as i,c as r,d as E,e as a}from"./table-D4yQmoYa.js";import{B as S}from"./badge-CAnxudGq.js";import{C,a as T,b as k,c as L}from"./card-CkON84C3.js";import{P as X}from"./panels-top-left-CoNC_ODY.js";import{C as Y}from"./clock-C1wc1VsE.js";/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=J("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ge=({isOpen:l,onClose:h})=>{const[d,n]=u.useState("IDLE"),[c,g]=u.useState([]),[m,o]=u.useState(null),R=u.useRef(null);u.useEffect(()=>{R.current&&(R.current.scrollTop=R.current.scrollHeight)},[c]);const I=async()=>{var j,p,s,f;n("DEPLOYING"),g(["Initializing deployment sequence...","Validating role permissions..."]),o(null);try{await new Promise(x=>setTimeout(x,500)),g(x=>[...x,"Sending deployment trigger to backend..."]);const{data:t}=await b.post("/deployment/deploy");t.logs&&Array.isArray(t.logs)&&g(x=>[...x,...t.logs]),g(x=>[...x,"Deployment Command Completed Successfully."]),n("SUCCESS")}catch(t){console.error(t);const x=((p=(j=t.response)==null?void 0:j.data)==null?void 0:p.message)||t.message||"Unknown error occurred";o(x),(f=(s=t.response)==null?void 0:s.data)!=null&&f.logs&&Array.isArray(t.response.data.logs)&&g(y=>[...y,...t.response.data.logs]),g(y=>[...y,`CRITICAL FAIL: ${x}`]),n("ERROR")}},N=()=>{d!=="DEPLOYING"&&(n("IDLE"),g([]),o(null),h())};return e.jsx(F,{open:l,onOpenChange:j=>!j&&N(),children:e.jsx(B,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{size:18,className:"text-purple-600"}),"Update Online System"]}),className:"max-w-2xl",hideDraggableBar:!1,children:e.jsxs("div",{className:"p-6 pt-0 space-y-4",children:[e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/10 p-4 rounded-lg border border-purple-100 dark:border-purple-800",children:[e.jsxs("h3",{className:"font-semibold text-purple-900 dark:text-purple-300 flex items-center gap-2",children:[e.jsx(Z,{size:16})," Admin Zone: Production Deployment"]}),e.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-400 mt-1",children:"This action will push your local code to the repo and trigger an update on the live VPS (66.116.224.221). The system may be briefly unavailable during restart."})]}),e.jsxs("div",{className:"bg-slate-950 rounded-lg border border-slate-800 p-4 font-mono text-xs h-64 overflow-y-auto flex flex-col shadow-inner",ref:R,children:[c.length===0&&d==="IDLE"&&e.jsx("div",{className:"text-slate-500 italic my-auto text-center",children:"Ready to deploy. Waiting for confirmation..."}),c.map((j,p)=>e.jsxs("div",{className:"text-slate-300 border-b border-slate-900/50 pb-0.5 mb-0.5 last:border-0 last:mb-0 break-all",children:[e.jsxs("span",{className:"text-slate-600 mr-2",children:["[",new Date().toLocaleTimeString(),"]"]}),j]},p)),d==="DEPLOYING"&&e.jsx("div",{className:"text-purple-400 animate-pulse mt-2",children:"Processing..."})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{className:"text-sm",children:[d==="SUCCESS"&&e.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-2",children:[e.jsx(xe,{size:16})," Update Complete"]}),d==="ERROR"&&e.jsxs("span",{className:"text-red-600 font-medium flex items-center gap-2",children:[e.jsx(me,{size:16})," Update Failed"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:N,disabled:d==="DEPLOYING",className:"px-4 py-2 text-sm text-muted-foreground hover:text-foreground disabled:opacity-50",children:d==="SUCCESS"?"Close":"Cancel"}),d!=="SUCCESS"&&e.jsxs("button",{onClick:I,disabled:d==="DEPLOYING",className:"px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-md text-sm font-medium shadow-sm transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:[d==="DEPLOYING"?e.jsx(he,{size:16,className:"animate-spin"}):e.jsx(U,{size:16}),d==="DEPLOYING"?"Deploying...":d==="ERROR"?"Retry Update":"Start Update"]})]})]})]})})})},M=()=>{var N,j,p,s,f;const{user:l}=O(),h=G(),[d,n]=u.useState(!1),{data:c,isLoading:g}=A({queryKey:["dashboard-stats-v2"],queryFn:async()=>{const{data:t}=await b.get("/tasks/stats");return t}}),{data:m,isLoading:o}=A({queryKey:["creative-dashboard"],queryFn:async()=>(await b.get("/analytics/creative-dashboard")).data});if(g||o)return e.jsx("div",{className:"p-8 text-center text-gray-500 animate-pulse",children:"Loading dashboard elements..."});const{distribution:R,efficiency:I}=c||{distribution:[],efficiency:[]};return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Marketing & SEO Overview"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Real-time insights into team performance and task distribution."})]}),(l==null?void 0:l.role)==="DEVELOPER_ADMIN"&&e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors shadow-sm text-sm font-medium",children:[e.jsx(U,{size:16}),"Update Online System"]})]}),e.jsx(ge,{isOpen:d,onClose:()=>n(!1)}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs(C,{className:"border shadow-lg rounded-xl overflow-hidden bg-white",children:[e.jsx(T,{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-4 px-6",children:e.jsxs(k,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(X,{size:20}),"Creative Tasks Assigned Today"]})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"w-[80px] font-bold",children:"S.No"}),e.jsx(r,{className:"font-bold",children:"Staff Name"}),e.jsx(r,{className:"font-bold",children:"Client"}),e.jsx(r,{className:"font-bold",children:"Task Type"}),e.jsx(r,{className:"font-bold",children:"Assigned By"})]})}),e.jsx(E,{children:o?e.jsx(i,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground animate-pulse font-medium",children:"Synchronizing today's assignments..."})}):((N=m==null?void 0:m.dailyTasks)==null?void 0:N.length)===0?e.jsx(i,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground italic font-medium",children:"No new creative tasks assigned yet today."})}):(j=m==null?void 0:m.dailyTasks)==null?void 0:j.map(t=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"font-semibold text-gray-500",children:t.s_no}),e.jsx(a,{className:"font-bold text-gray-900",children:t.staff_name}),e.jsx(a,{className:"font-bold text-indigo-600",children:t.client_name}),e.jsx(a,{children:e.jsx(S,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-100 font-bold",children:t.task_type})}),e.jsx(a,{className:"text-gray-600 font-medium",children:t.assigned_by})]},t.id))})]})})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(T,{className:"bg-emerald-600 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(k,{className:"text-sm font-bold",children:"Today's Efficiency"}),e.jsx(K,{size:16})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold uppercase",children:"Member"}),e.jsx(r,{className:"text-xs font-bold text-right uppercase",children:"Score"})]})}),e.jsx(E,{children:(p=m==null?void 0:m.dailyEfficiency)==null?void 0:p.map(t=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"text-sm font-bold text-gray-700",children:t.staff_name}),e.jsx(a,{className:"text-right",children:e.jsxs(S,{className:`${t.efficiency>=80?"bg-green-100 text-green-700 border-green-200":t.efficiency>=50?"bg-amber-100 text-amber-700 border-amber-200":"bg-red-100 text-red-700 border-red-200"} font-black text-xs px-2`,children:[t.efficiency,"%"]})})]},t.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(T,{className:"bg-cyan-600 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(k,{className:"text-sm font-bold",children:"Weekly Performance"}),e.jsx(W,{size:16})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold uppercase",children:"Member"}),e.jsx(r,{className:"text-xs font-bold text-right uppercase",children:"Avg"})]})}),e.jsx(E,{children:(s=m==null?void 0:m.weeklyEfficiency)==null?void 0:s.map(t=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"text-sm font-bold text-gray-700",children:t.staff_name}),e.jsx(a,{className:"text-right",children:e.jsx("span",{className:`inline-flex items-center justify-center w-8 h-8 rounded-full font-black text-xs ${t.efficiency>=80?"bg-green-600 text-white":t.efficiency>=50?"bg-cyan-600 text-white":"bg-slate-400 text-white shadow-inner uppercase"}`,children:t.efficiency})})]},t.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(T,{className:"bg-rose-600 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(k,{className:"text-sm font-bold",children:"Monthly Efficacy"}),e.jsx(H,{size:18})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold uppercase",children:"Member"}),e.jsx(r,{className:"text-xs font-bold text-right uppercase",children:"Progress"})]})}),e.jsx(E,{children:(f=m==null?void 0:m.monthlyEfficiency)==null?void 0:f.map(t=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"text-sm font-bold text-gray-700",children:t.staff_name}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("span",{className:"text-[10px] font-black text-rose-600 leading-none",children:[t.efficiency,"%"]}),e.jsx("div",{className:"w-16 h-2 bg-gray-100 rounded-full overflow-hidden shadow-inner border border-gray-200",children:e.jsx("div",{className:"h-full bg-rose-500 shadow-sm",style:{width:`${t.efficiency}%`}})})]})})]},t.id))})]})})})]})]}),e.jsxs("div",{onClick:()=>h("/dashboard/client-portal/manage-services"),className:"bg-white p-6 rounded-xl shadow-lg border-2 border-dashed border-indigo-200 hover:border-indigo-400 hover:bg-indigo-50/30 transition-all cursor-pointer flex items-center justify-between group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-indigo-100 rounded-2xl text-indigo-600 group-hover:scale-110 transition-transform shadow-sm",children:e.jsx(q,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 group-hover:text-indigo-700 transition-colors",children:"Lead Management & Campaign History"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Track daily leads, follow-ups, and active service performances."})]})]}),e.jsxs("div",{className:"mr-4 text-indigo-600 font-black flex items-center gap-2 group-hover:translate-x-1 transition-transform",children:["Open Manager ",e.jsx(q,{size:20})]})]})]})},$=()=>{var R,I,N,j,p;const{user:l}=O(),{data:h,isLoading:d}=A({queryKey:["designer-stats"],queryFn:async()=>{const{data:s}=await b.get("/tasks/stats");return s}}),{data:n,isLoading:c}=A({queryKey:["creative-dashboard"],queryFn:async()=>(await b.get("/analytics/creative-dashboard")).data}),{data:g,isLoading:m}=A({queryKey:["tasks","my-active",l==null?void 0:l.id],queryFn:async()=>{const{data:s}=await b.get("/tasks",{params:{assignee_id:l==null?void 0:l.id}});return s.filter(f=>["ASSIGNED","IN_PROGRESS","REVIEW","REVISION_REQUESTED"].includes(f.status))},enabled:!!(l!=null&&l.id)});if(d||c||m)return e.jsx("div",{className:"p-8 text-center text-gray-500 animate-pulse",children:"Loading workspace..."});const{distribution:o}=h||{distribution:[]};return h!=null&&h.efficiency[0],e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent",children:"My Creative Space"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track your tasks and performance."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs(C,{className:"border shadow-lg rounded-xl overflow-hidden bg-slate-900 text-white",children:[e.jsx(T,{className:"bg-slate-800 py-4 px-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(te,{size:20,className:"text-orange-400"}),"My Active Tasks"]}),e.jsxs(S,{className:"bg-orange-500 text-white border-none",children:[(g==null?void 0:g.length)||0," Pending"]})]})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-slate-800/50",children:e.jsxs(i,{className:"border-slate-700 hover:bg-transparent",children:[e.jsx(r,{className:"text-slate-400 font-bold",children:"Task Title"}),e.jsx(r,{className:"text-slate-400 font-bold",children:"Client"}),e.jsx(r,{className:"text-slate-400 font-bold",children:"Type"}),e.jsx(r,{className:"text-slate-400 font-bold",children:"Deadline"}),e.jsx(r,{className:"text-slate-400 font-bold text-right",children:"Status"})]})}),e.jsx(E,{children:!g||g.length===0?e.jsx(i,{className:"border-slate-800",children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-slate-500 italic font-medium",children:"No active tasks assigned to you. Enjoy the breather!"})}):g.map(s=>{var f;return e.jsxs(i,{className:"border-slate-800 hover:bg-slate-800/50 transition-colors",children:[e.jsx(a,{className:"font-bold",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.title}),e.jsx("span",{className:"text-[10px] text-slate-500 font-normal truncate max-w-[300px]",children:s.description})]})}),e.jsx(a,{className:"font-medium text-orange-400",children:((f=s.client)==null?void 0:f.name)||"Internal"}),e.jsx(a,{children:e.jsx(S,{className:"bg-slate-700 text-slate-300 border-slate-600",variant:"outline",children:s.type})}),e.jsx(a,{className:"text-slate-400 text-sm",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Y,{size:12}),s.due_date?new Date(s.due_date).toLocaleDateString():"No Set Date"]})}),e.jsx(a,{className:"text-right",children:e.jsx(S,{className:`
                                                        ${s.status==="REVIEW"?"bg-amber-500":s.status==="IN_PROGRESS"?"bg-blue-600":s.status==="REVISION_REQUESTED"?"bg-red-500":"bg-slate-600"} 
                                                        text-white border-none font-bold text-[10px]
                                                    `,children:s.status.replace(/_/g," ")})})]},s.id)})})]})})})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs(C,{className:"border shadow-lg rounded-xl overflow-hidden bg-white",children:[e.jsx(T,{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 px-6",children:e.jsxs(k,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(X,{size:20}),"My Team's Tasks Assigned Today"]})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"w-[80px] font-bold",children:"S.No"}),e.jsx(r,{className:"font-bold",children:"Staff Name"}),e.jsx(r,{className:"font-bold",children:"Client"}),e.jsx(r,{className:"font-bold",children:"Task Type"}),e.jsx(r,{className:"font-bold",children:"Assigned By"})]})}),e.jsx(E,{children:c?e.jsx(i,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground animate-pulse font-medium text-sm",children:"Refreshing creative assignments..."})}):((R=n==null?void 0:n.dailyTasks)==null?void 0:R.length)===0?e.jsx(i,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground italic font-medium text-sm",children:"No tasks assigned to your team yet today."})}):(I=n==null?void 0:n.dailyTasks)==null?void 0:I.map(s=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"font-semibold text-gray-400",children:s.s_no}),e.jsx(a,{className:"font-bold text-gray-800",children:s.staff_name}),e.jsx(a,{className:"font-bold text-orange-600",children:s.client_name}),e.jsx(a,{children:e.jsx(S,{className:"bg-orange-50 text-orange-700 border-orange-100 font-bold",variant:"outline",children:s.task_type})}),e.jsx(a,{className:"text-gray-500 font-medium",children:s.assigned_by})]},s.id))})]})})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(T,{className:"bg-amber-500 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(k,{className:"text-sm font-bold",children:"Daily Scorecard"}),e.jsx(K,{size:18})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold uppercase",children:"Staff"}),e.jsx(r,{className:"text-xs font-bold text-right uppercase",children:"Efficiency"})]})}),e.jsx(E,{children:(N=n==null?void 0:n.dailyEfficiency)==null?void 0:N.map(s=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs(a,{className:`text-sm font-bold ${s.id===(l==null?void 0:l.id)?"text-orange-600":"text-gray-600"}`,children:[s.staff_name," ",s.id===(l==null?void 0:l.id)&&"(Me)"]}),e.jsx(a,{className:"text-right",children:e.jsxs(S,{className:`${s.efficiency>=80?"bg-green-100 text-green-700 border-green-200":s.efficiency>=50?"bg-orange-100 text-orange-700 border-orange-200":"bg-red-100 text-red-700 border-red-200"} font-black text-xs`,children:[s.efficiency,"%"]})})]},s.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(T,{className:"bg-blue-500 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(k,{className:"text-sm font-bold",children:"Weekly Performance"}),e.jsx(W,{size:18})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold uppercase",children:"Staff"}),e.jsx(r,{className:"text-xs font-bold text-right uppercase",children:"Rank"})]})}),e.jsx(E,{children:(j=n==null?void 0:n.weeklyEfficiency)==null?void 0:j.map(s=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:`text-sm font-bold ${s.id===(l==null?void 0:l.id)?"text-blue-600":"text-gray-600"}`,children:s.staff_name}),e.jsx(a,{className:"text-right",children:e.jsx("span",{className:`inline-flex items-center justify-center w-8 h-8 rounded-full font-black text-xs ${s.efficiency>=80?"bg-green-500 text-white shadow-sm":s.efficiency>=50?"bg-blue-500 text-white shadow-sm":"bg-slate-300 text-white shadow-inner"}`,children:s.efficiency})})]},s.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(T,{className:"bg-indigo-500 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(k,{className:"text-sm font-bold",children:"Monthly Efficacy"}),e.jsx(H,{size:20})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold uppercase",children:"Staff"}),e.jsx(r,{className:"text-xs font-bold text-right uppercase",children:"Track"})]})}),e.jsx(E,{children:(p=n==null?void 0:n.monthlyEfficiency)==null?void 0:p.map(s=>e.jsxs(i,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:`text-sm font-bold ${s.id===(l==null?void 0:l.id)?"text-indigo-600":"text-gray-600"}`,children:s.staff_name}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("span",{className:"text-[10px] font-black text-indigo-600 leading-none",children:[s.efficiency,"%"]}),e.jsx("div",{className:"w-16 h-2 bg-gray-100 rounded-full overflow-hidden shadow-inner border border-gray-100",children:e.jsx("div",{className:`h-full ${s.id===(l==null?void 0:l.id)?"bg-indigo-600 shadow-md":"bg-indigo-400 opacity-60"}`,style:{width:`${s.efficiency}%`}})})]})})]},s.id))})]})})})]})]})]})},Q=u.forwardRef(({className:l,children:h,...d},n)=>e.jsx("div",{ref:n,className:ae("relative overflow-auto",l),...d,children:h}));Q.displayName="ScrollArea";const fe=({trigger:l,highlightId:h,autoOpen:d,onOpenChange:n})=>{const[c,g]=u.useState([]),[m,o]=u.useState(!1),R=s=>{o(s),n&&n(s)},[I,N]=u.useState(!1);u.useEffect(()=>{(h||d)&&o(!0)},[h,d]),u.useEffect(()=>{m&&h&&c.length>0&&setTimeout(()=>{const s=document.getElementById(`request-${h}`);s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.classList.add("ring-2","ring-primary"))},500)},[m,h,c]);const j=async()=>{N(!0);try{const[s,f]=await Promise.all([b.get("/leave/requests"),b.get("/attendance/regularisation/requests?status=PENDING")]),t=s.data.map(y=>({...y,category:"LEAVE"})),x=f.data.map(y=>({...y,category:"REGULARISATION"}));g([...t,...x].sort((y,P)=>new Date(P.createdAt).getTime()-new Date(y.createdAt).getTime()))}catch(s){console.error("Failed to fetch requests",s)}finally{N(!1)}};u.useEffect(()=>{m&&j()},[m]);const p=async(s,f,t)=>{try{const x=f==="LEAVE"?`/leave/${s}/status`:`/attendance/regularisation/${s}/status`;await b.patch(x,{status:t}),j()}catch(x){console.error("Failed to update status",x),alert("Failed to process request.")}};return e.jsxs(F,{open:m,onOpenChange:R,children:[e.jsx(le,{asChild:!0,children:l}),e.jsxs(B,{className:"sm:max-w-[600px] h-[80vh] flex flex-col p-0 gap-0",children:[e.jsx(re,{className:"p-6 pb-2 border-b border-border",children:e.jsxs(ne,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),"Pending Approvals",e.jsx(S,{variant:"secondary",className:"ml-2",children:c.length})]})}),e.jsx(Q,{className:"flex-1 p-6 pt-2",children:I?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading requests..."}):c.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(z,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"All caught up! No pending requests."})]}):e.jsx("div",{className:"space-y-4 pt-4",children:c.map(s=>{var f,t,x,y,P;return e.jsxs("div",{id:`request-${s.id}`,className:"border rounded-lg p-4 bg-card shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold",children:((t=(f=s.user)==null?void 0:f.full_name)==null?void 0:t.charAt(0))||e.jsx(ie,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:(x=s.user)==null?void 0:x.full_name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[(y=s.user)==null?void 0:y.department," â€¢ ",(P=s.user)==null?void 0:P.role]})]})]}),e.jsx(S,{variant:s.category==="LEAVE"?"default":"outline",className:s.category==="LEAVE"?"bg-primary/20 text-primary hover:bg-primary/30 border-primary/20":"text-blue-500 border-blue-500/50",children:s.category==="LEAVE"?"Leave Application":"Attendance Regularisation"})]}),e.jsxs("div",{className:"ml-12 space-y-2 mb-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs block mb-1",children:"Type"}),e.jsx("span",{className:"font-medium",children:s.type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs block mb-1",children:"Dates"}),s.category==="LEAVE"?e.jsxs("span",{className:"font-medium",children:[new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]}):e.jsx("span",{className:"font-medium",children:new Date(s.date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"bg-muted/50 p-2 rounded text-sm text-muted-foreground",children:[e.jsx(de,{className:"h-3 w-3 inline mr-1"}),s.reason]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2 border-t mt-2",children:[e.jsxs(D,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 border-destructive/20",onClick:()=>p(s.id,s.category,"REJECTED"),children:[e.jsx(ce,{className:"h-4 w-4 mr-1"})," Reject"]}),e.jsxs(D,{size:"sm",className:"bg-green-600 dark:bg-green-700 hover:bg-green-700 dark:hover:bg-green-600 text-white",onClick:()=>p(s.id,s.category,"APPROVED"),children:[e.jsx(z,{className:"h-4 w-4 mr-1"})," Approve"]})]})]},s.id)})})})]})]})},je=()=>{const[l,h]=u.useState(document.documentElement.classList.contains("dark"));return u.useEffect(()=>{const d=new MutationObserver(n=>{n.forEach(c=>{c.attributeName==="class"&&h(document.documentElement.classList.contains("dark"))})});return d.observe(document.documentElement,{attributes:!0}),()=>d.disconnect()},[]),l},V=()=>{var N,j,p,s,f;const{user:l}=O();G(),je();const[h,d]=ee(),n=h.get("requestId"),{data:c}=A({queryKey:["creative-metrics"],queryFn:async()=>(await b.get("/analytics/creative-metrics")).data}),{data:g}=A({queryKey:["attendance-stats"],queryFn:async()=>(await b.get("/analytics/attendance")).data}),{data:m}=A({queryKey:["team-performance"],queryFn:async()=>(await b.get("/analytics/team-performance")).data}),{data:o,isLoading:R}=A({queryKey:["creative-dashboard"],queryFn:async()=>(await b.get("/analytics/creative-dashboard")).data}),{data:I}=A({queryKey:["pending-requests-count"],queryFn:async()=>{const[t,x]=await Promise.all([b.get("/leave/requests"),b.get("/attendance/regularisation/requests?status=PENDING")]);return t.data.filter(P=>P.status==="PENDING").length+x.data.length},refetchInterval:3e4});return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 text-sm md:text-base",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 py-4 border-b",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-foreground",children:"Overview"})}),e.jsx("div",{className:"flex items-center gap-6",children:e.jsx(fe,{highlightId:n,autoOpen:!!n||h.get("action")==="review_request",onOpenChange:t=>{if(!t&&(n||h.get("action"))){const x=new URLSearchParams(h);x.delete("requestId"),x.delete("type"),x.delete("action"),d(x)}},trigger:e.jsxs(D,{variant:"outline",className:"gap-2 shadow-sm border-orange-200 bg-orange-50/50 hover:bg-orange-50 text-orange-700 relative",children:[e.jsx(oe,{className:"h-4 w-4"}),"Pending Requests",I>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 rounded-full bg-red-500 animate-pulse ring-2 ring-white"})]})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:g==null?void 0:g.map(t=>e.jsxs("div",{className:`p-6 rounded-xl shadow-sm hover:shadow-md transition-all ${t.styles.card}`,children:[e.jsx("h3",{className:`text-xs font-bold uppercase tracking-wider mb-2 ${t.styles.label}`,children:t.department}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:`text-4xl font-extrabold ${t.styles.value}`,children:t.count}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm ${t.styles.text}`,children:"Present"})]})]},t.department))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-purple-50 dark:bg-purple-900/10 border border-purple-100 dark:border-purple-900/20",children:[e.jsx("h3",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300",children:"Total Assigned"}),e.jsx("p",{className:"text-2xl font-bold mt-1 text-purple-900 dark:text-purple-100",children:(c==null?void 0:c.total)||0})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-green-50 dark:bg-green-900/10 border border-green-100 dark:border-green-900/20",children:[e.jsx("h3",{className:"text-xs font-semibold text-green-700 dark:text-green-300",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold mt-1 text-green-900 dark:text-green-100",children:(c==null?void 0:c.completed)||0})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/20",children:[e.jsx("h3",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300",children:"In Progress"}),e.jsx("p",{className:"text-2xl font-bold mt-1 text-blue-900 dark:text-blue-100",children:(c==null?void 0:c.wip)||0})]})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(C,{className:"border shadow-sm h-full rounded-xl overflow-hidden",children:[e.jsx(T,{className:"bg-gray-50/50 py-3 px-4 border-b",children:e.jsxs(k,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(S,{variant:"outline",className:"bg-indigo-100 text-indigo-700 border-indigo-200",children:"New"}),"Creative Tasks Assigned Today"]})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50/30",children:e.jsxs(i,{children:[e.jsx(r,{className:"w-[80px] text-xs font-bold",children:"S.No"}),e.jsx(r,{className:"text-xs font-bold",children:"Staff Name"}),e.jsx(r,{className:"text-xs font-bold",children:"Client"}),e.jsx(r,{className:"text-xs font-bold",children:"Task Type"}),e.jsx(r,{className:"text-xs font-bold",children:"Assigned By"})]})}),e.jsx(E,{children:R?e.jsx(i,{children:e.jsx(a,{colSpan:5,className:"h-24 text-center text-xs text-muted-foreground animate-pulse",children:"Loading today's tasks..."})}):((N=o==null?void 0:o.dailyTasks)==null?void 0:N.length)===0?e.jsx(i,{children:e.jsx(a,{colSpan:5,className:"h-24 text-center text-xs text-muted-foreground italic",children:"No tasks assigned yet today."})}):(j=o==null?void 0:o.dailyTasks)==null?void 0:j.map(t=>e.jsxs(i,{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsx(a,{className:"text-xs font-medium text-gray-500",children:t.s_no}),e.jsx(a,{className:"text-xs font-bold text-gray-900",children:t.staff_name}),e.jsx(a,{className:"text-xs font-medium text-indigo-600",children:t.client_name}),e.jsx(a,{className:"text-xs font-medium",children:e.jsx(S,{variant:"outline",className:"text-[10px] font-bold py-0",children:t.task_type})}),e.jsx(a,{className:"text-xs text-gray-600",children:t.assigned_by})]},t.id))})]})})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"border shadow-sm rounded-xl overflow-hidden",children:[e.jsx(T,{className:"bg-indigo-600 text-white py-3 px-4",children:e.jsx(k,{className:"text-sm font-bold",children:"Creative Team Performance (Daily)"})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50/50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold",children:"Staff"}),e.jsx(r,{className:"text-xs font-bold text-center",children:"Assigned"}),e.jsx(r,{className:"text-xs font-bold text-center",children:"Completed"}),e.jsx(r,{className:"text-xs font-bold text-right",children:"Efficiency"})]})}),e.jsx(E,{children:(p=o==null?void 0:o.dailyEfficiency)==null?void 0:p.map(t=>e.jsxs(i,{className:"hover:bg-gray-50/50",children:[e.jsx(a,{className:"text-xs font-semibold whitespace-nowrap",children:t.staff_name}),e.jsx(a,{className:"text-xs text-center font-medium",children:t.assigned}),e.jsx(a,{className:"text-xs text-center font-bold text-green-600",children:t.completed}),e.jsx(a,{className:"text-right",children:e.jsxs(S,{className:`${t.efficiency>=80?"bg-green-100 text-green-700":t.efficiency>=50?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"} text-[10px] font-bold`,children:[t.efficiency,"%"]})})]},t.id))})]})})})]}),e.jsxs(C,{className:"border shadow-sm rounded-xl overflow-hidden",children:[e.jsx(T,{className:"bg-blue-600 text-white py-3 px-4",children:e.jsx(k,{className:"text-sm font-bold",children:"Creative Team Performance (Weekly)"})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50/50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold",children:"Staff"}),e.jsx(r,{className:"text-xs font-bold text-center",children:"Assigned"}),e.jsx(r,{className:"text-xs font-bold text-center",children:"Completed"}),e.jsx(r,{className:"text-xs font-bold text-right",children:"Efficiency"})]})}),e.jsx(E,{children:(s=o==null?void 0:o.weeklyEfficiency)==null?void 0:s.map(t=>e.jsxs(i,{className:"hover:bg-gray-50/50",children:[e.jsx(a,{className:"text-xs font-semibold whitespace-nowrap",children:t.staff_name}),e.jsx(a,{className:"text-xs text-center font-medium",children:t.assigned}),e.jsx(a,{className:"text-xs text-center font-bold text-blue-600",children:t.completed}),e.jsx(a,{className:"text-right",children:e.jsxs(S,{className:`${t.efficiency>=80?"bg-green-500 text-white":t.efficiency>=50?"bg-blue-500 text-white":"bg-gray-400 text-white"} text-[10px] font-bold`,children:[t.efficiency,"%"]})})]},t.id))})]})})})]}),e.jsxs(C,{className:"border shadow-sm rounded-xl overflow-hidden",children:[e.jsx(T,{className:"bg-purple-600 text-white py-3 px-4",children:e.jsx(k,{className:"text-sm font-bold",children:"Creative Team Performance (Monthly)"})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{className:"bg-gray-50/50",children:e.jsxs(i,{children:[e.jsx(r,{className:"text-xs font-bold",children:"Staff"}),e.jsx(r,{className:"text-xs font-bold text-center",children:"Assigned"}),e.jsx(r,{className:"text-xs font-bold text-center",children:"Completed"}),e.jsx(r,{className:"text-xs font-bold text-right",children:"Efficiency"})]})}),e.jsx(E,{children:(f=o==null?void 0:o.monthlyEfficiency)==null?void 0:f.map(t=>e.jsxs(i,{className:"hover:bg-gray-50/50",children:[e.jsx(a,{className:"text-xs font-semibold whitespace-nowrap",children:t.staff_name}),e.jsx(a,{className:"text-xs text-center font-medium",children:t.assigned}),e.jsx(a,{className:"text-xs text-center font-bold text-purple-600",children:t.completed}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs("span",{className:"text-[10px] font-bold text-gray-600",children:[t.efficiency,"%"]}),e.jsx("div",{className:"w-12 h-1.5 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500",style:{width:`${t.efficiency}%`}})})]})})]},t.id))})]})})})]})]})]})},ke=()=>{const{user:l}=O();if(!l)return null;if(l.role===_.CLIENT)return e.jsx(se,{to:"/dashboard/client-portal",replace:!0});switch(l.role){case _.DEVELOPER_ADMIN:case _.ADMIN:case _.MANAGER:return e.jsx(V,{});case _.DM_EXECUTIVE:case _.MARKETING_EXEC:case _.WEB_SEO_EXECUTIVE:case _.OPERATIONS_EXECUTIVE:return e.jsx(M,{});case _.CREATIVE_DESIGNER:return e.jsx($,{});default:return l.role.includes("DESIGNER")?e.jsx($,{}):l.role.includes("EXECUTIVE")?e.jsx(M,{}):l.role.includes("ADMIN")||l.role.includes("MANAGER")?e.jsx(V,{}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsxs("h3",{className:"text-xl font-bold mb-2",children:["Welcome, ",l.full_name]}),e.jsxs("p",{children:["Dashboard view not configured for role: ",l.role]})]})}};export{ke as default};
