import{r as x,C as b,j as e,x as m}from"./index-DTs_gUpQ.js";import{a2 as y,I as h,B as S}from"./index-BPHe9uWR.js";import{C as g,a as N,b as R,c as v}from"./card-CkON84C3.js";import{L as c}from"./label-CYspnl4A.js";import{S as E,a as _,b as C,c as I,d as r}from"./select-MX7Oli-8.js";import"./index-Bs76HOJd.js";import"./index-D_f1ssGG.js";const P=()=>{const{register:d,handleSubmit:p,setValue:l,watch:j}=y(),[o,u]=x.useState(!1),[s,i]=x.useState(null),n=j("date");b.useEffect(()=>{(async()=>{if(n)try{const{data:a}=await m.get(`/attendance/shifts/active?date=${n}`);i(a)}catch(a){console.error("Failed to fetch shift",a),i(null)}else i(null)})()},[n]);const f=async t=>{u(!0);try{await m.post("/attendance/regularisation/request",{date:t.date,type:t.type,reason:t.reason}),alert("Regularisation request submitted successfully!"),l("reason",""),l("date",""),l("type",""),i(null)}catch(a){console.error(a),alert("Failed to submit request.")}finally{u(!1)}};return e.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Attendance Regularisation"}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsx(R,{children:"Request Correction"})}),e.jsx(v,{children:e.jsxs("form",{onSubmit:p(f),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Date of Discrepancy"}),e.jsx(h,{type:"date",...d("date",{required:!0})})]}),s&&e.jsxs("div",{className:"bg-blue-50 p-3 rounded-md border border-blue-200",children:[e.jsx("p",{className:"text-sm text-blue-900 font-semibold mb-1",children:"Expected Shift"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-blue-700",children:[e.jsx("span",{children:s.name}),e.jsxs("span",{className:"font-mono bg-blue-100 px-1 rounded",children:[s.start_time," - ",s.end_time]}),s.default_grace_time>0&&e.jsxs("span",{children:["Grace: ",s.default_grace_time," mins"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Issue Type"}),e.jsxs(E,{onValueChange:t=>l("type",t),children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Select Issue Type"})}),e.jsxs(I,{children:[e.jsx(r,{value:"MISSED_PUNCH_IN",children:"Missed Punch In"}),e.jsx(r,{value:"MISSED_PUNCH_OUT",children:"Missed Punch Out"}),e.jsx(r,{value:"LATE_ARRIVAL",children:"Late Arrival Exception"}),e.jsx(r,{value:"EARLY_DEPARTURE",children:"Early Departure Exception"}),e.jsx(r,{value:"WORK_FROM_HOME",children:"Work From Home (Forgot to Apply)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Reason"}),e.jsx(h,{...d("reason",{required:!0}),placeholder:"e.g. Forgot ID card, Network issue..."})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(S,{type:"submit",disabled:o,children:o?"Submitting...":"Submit Request"})})]})})]})]})};export{P as default};
