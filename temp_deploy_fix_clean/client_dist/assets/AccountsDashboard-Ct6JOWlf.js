import{r as l,j as e,x as p}from"./index-_K9dBzXA.js";import{L as M}from"./LedgerManagement-BdLMclpM.js";import{u as y,Y as T}from"./index-C0_MxDCy.js";import k from"./AccountStatement-BF_7Atou.js";import"./format-D4js0obD.js";import"./pencil-Cl0nWfVN.js";import"./jspdf.es.min-DaBCeuWy.js";import"./jspdf.plugin.autotable-CtA5BUKo.js";import"./printer-BV8c6w5B.js";const A=()=>{var j,N,f,v,w;const[r,d]=l.useState("summary"),[n,x]=l.useState(new Date().getMonth()+1),[o,S]=l.useState(new Date().getFullYear()),[i,L]=l.useState(""),[m,_]=l.useState(new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0]),[h,C]=l.useState(new Date().toISOString().split("T")[0]),{data:a,isLoading:u}=y({queryKey:["salary-report",n,o],queryFn:async()=>(await p.get("/payroll/run",{params:{month:n,year:o}})).data,enabled:r==="summary"}),{data:g}=y({queryKey:["staff-list-simple"],queryFn:async()=>(await p.get("/team/staff")).data}),{data:s,isLoading:b}=y({queryKey:["staff-ledger",i,m,h],queryFn:async()=>i?(await p.get("/accounting/reports/statement",{params:{entity_type:"USER",entity_id:i,start_date:m,end_date:h}})).data:null,enabled:r==="ledger"&&!!i});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Salary & Wages Report"}),e.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>d("summary"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-all ${r==="summary"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Monthly Summary"}),e.jsx("button",{onClick:()=>d("ledger"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-all ${r==="ledger"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Staff Ledgers"})]})]}),r==="summary"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-left-4",children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-4 rounded-xl border border-gray-100",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Period:"}),e.jsx("select",{value:n,onChange:t=>x(parseInt(t.target.value)),className:"border rounded-md px-3 py-1.5 text-sm bg-white",children:Array.from({length:12},(t,c)=>e.jsx("option",{value:c+1,children:new Date(0,c).toLocaleString("default",{month:"long"})},c+1))}),e.jsxs("select",{value:o,onChange:t=>S(parseInt(t.target.value)),className:"border rounded-md px-3 py-1.5 text-sm bg-white",children:[e.jsx("option",{value:2024,children:"2024"}),e.jsx("option",{value:2025,children:"2025"}),e.jsx("option",{value:2026,children:"2026"})]})]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-white border rounded-md text-sm hover:bg-gray-50 text-gray-700",children:[e.jsx(T,{size:16})," Export CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Total Payout Settled"}),e.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:["₹",((j=a==null?void 0:a.total_payout)==null?void 0:j.toLocaleString())||"0"]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Total Deductions"}),e.jsxs("h3",{className:"text-2xl font-bold text-red-600",children:["₹",((N=a==null?void 0:a.total_deductions)==null?void 0:N.toLocaleString())||"0"]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Staff Processed"}),e.jsx("h3",{className:"text-2xl font-bold text-blue-600",children:((f=a==null?void 0:a.slips)==null?void 0:f.length)||0})]})]}),e.jsx("div",{className:"bg-white rounded-xl border shadow-sm overflow-hidden dash-table-container",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 font-medium border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Staff Name"}),e.jsx("th",{className:"px-6 py-3",children:"Designation"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Basic + Allowances"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Deductions"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Net Pay"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Status"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[u?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8",children:"Loading..."})}):(v=a==null?void 0:a.slips)==null?void 0:v.map(t=>{var c;return e.jsxs("tr",{className:"hover:bg-gray-50/50",children:[e.jsx("td",{className:"px-6 py-3 font-medium text-gray-900",children:t.name||((c=t.user)==null?void 0:c.full_name)}),e.jsx("td",{className:"px-6 py-3 text-gray-500",children:t.designation}),e.jsxs("td",{className:"px-6 py-3 text-right",children:["₹",(t.basic_salary+t.hra+t.allowances+t.conveyance_allowance).toLocaleString()]}),e.jsxs("td",{className:"px-6 py-3 text-right text-red-500",children:["-₹",(t.lop_deduction+t.advance_salary+t.other_deductions).toLocaleString()]}),e.jsxs("td",{className:"px-6 py-3 text-right font-bold text-gray-900",children:["₹",t.net_pay.toLocaleString()]}),e.jsx("td",{className:"px-6 py-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="PAID"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:t.status})})]},t.id)}),!u&&(!(a!=null&&a.slips)||a.slips.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No payroll records found for this month."})})]})]})})]}),r==="ledger"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-end bg-blue-50/50 p-4 rounded-xl border border-blue-100",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Select Staff Member"}),e.jsxs("select",{value:i,onChange:t=>L(t.target.value),className:"w-full border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-200 outline-none",children:[e.jsx("option",{value:"",children:"-- Choose Staff --"}),g==null?void 0:g.map(t=>e.jsxs("option",{value:t.user.id,children:[t.user.full_name," (",t.designation,")"]},t.user.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"From"}),e.jsx("input",{type:"date",value:m,onChange:t=>_(t.target.value),className:"border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-200 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"To"}),e.jsx("input",{type:"date",value:h,onChange:t=>C(t.target.value),className:"border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-200 outline-none"})]})]}),i?e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b bg-gray-50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"Ledger Statement"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Opening Balance: ",e.jsxs("span",{className:(s==null?void 0:s.opening_balance)<0?"text-red-600":"text-green-600",children:["₹",Math.abs((s==null?void 0:s.opening_balance)||0).toLocaleString()," ",(s==null?void 0:s.opening_balance)<0?"Dr":"Cr"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Closing Balance"}),e.jsxs("span",{className:`font-bold text-lg ${(s==null?void 0:s.ending_balance)<0?"text-red-600":"text-green-600"}`,children:["₹",Math.abs((s==null?void 0:s.ending_balance)||0).toLocaleString()," ",(s==null?void 0:s.ending_balance)<0?"Dr":"Cr"]})]})]}),e.jsx("div",{className:"dash-table-container max-h-[500px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 font-medium border-b sticky top-0 bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 w-[120px]",children:"Date"}),e.jsx("th",{className:"px-6 py-3",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-right w-[120px]",children:"Debit"}),e.jsx("th",{className:"px-6 py-3 text-right w-[120px]",children:"Credit"}),e.jsx("th",{className:"px-6 py-3 text-right w-[150px]",children:"Balance"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[b?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-8",children:"Loading Ledger..."})}):(w=s==null?void 0:s.transactions)==null?void 0:w.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50/50",children:[e.jsx("td",{className:"px-6 py-3 text-gray-600 font-mono text-xs",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-3 font-medium text-gray-900",children:t.description}),e.jsx("td",{className:"px-6 py-3 text-right text-gray-600",children:t.debit>0?`₹${t.debit.toLocaleString()}`:"-"}),e.jsx("td",{className:"px-6 py-3 text-right text-gray-600",children:t.credit>0?`₹${t.credit.toLocaleString()}`:"-"}),e.jsx("td",{className:"px-6 py-3 text-right font-medium",children:e.jsxs("span",{className:t.running_balance<0?"text-red-600":"text-green-600",children:[Math.abs(t.running_balance).toLocaleString()," ",t.running_balance<0?"Dr":"Cr"]})})]},t.id)),!b&&(!(s!=null&&s.transactions)||s.transactions.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-12 text-gray-400",children:"No transactions in this period."})})]})]})})]}):e.jsx("div",{className:"text-center py-12 border-2 border-dashed border-gray-200 rounded-xl bg-gray-50/50",children:e.jsx("p",{className:"text-gray-400",children:"Select a staff member to view their ledger statement."})})]}),e.jsx("style",{children:`
                .dash-table-container { scrollbar-width: thin; }
            `})]})},K=()=>{const[r,d]=l.useState("ledgers"),n=x=>`px-6 py-2 rounded-md font-bold transition-all shadow-sm border-2 ${r===x?"bg-purple-900 text-yellow-400 border-yellow-400":"bg-yellow-400 text-purple-900 border-transparent hover:opacity-90"}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex space-x-2 bg-transparent p-0 w-fit",children:[e.jsx("button",{onClick:()=>d("ledgers"),className:n("ledgers"),children:"Ledger Management"}),e.jsx("button",{onClick:()=>d("reports"),className:n("reports"),children:"Salary & Wages Reports"}),e.jsx("button",{onClick:()=>d("statements"),className:n("statements"),children:"Statements"})]}),r==="ledgers"&&e.jsx(M,{}),r==="reports"&&e.jsx(A,{}),r==="statements"&&e.jsx(k,{})]})};export{K as default};
