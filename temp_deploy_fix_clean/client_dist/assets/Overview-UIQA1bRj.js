import{v as F,r as p,j as e,E as Z,x as b,u as O,a as G,J as Q,N as ee}from"./index-_K9dBzXA.js";import{D as B,a as K,u as P,T as X,C as Y,U as z,c as se,b as te,d as ae,e as re,f as U,g as le,F as ne,B as D,X as ie,h as de,R as I}from"./index-C0_MxDCy.js";import{C as ce}from"./check-circle-DX-ak2PV.js";import{X as oe}from"./x-circle-DJEckX6R.js";import{L as xe}from"./loader-2-m9uN2hHg.js";import{T as v,a as E,b as d,c as l,d as k,e as a}from"./table-CZtgpgQ3.js";import{B as A}from"./badge-BRRI9-vD.js";import{C,a as S,b as T,c as L}from"./card-BJXC2BmV.js";import{P as H}from"./panels-top-left-B-CpYYg6.js";import{C as me}from"./clock-89fNMNOB.js";/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=F("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=F("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),he=({isOpen:n,onClose:g})=>{const[o,i]=p.useState("IDLE"),[h,f]=p.useState([]),[x,c]=p.useState(null),w=p.useRef(null);p.useEffect(()=>{w.current&&(w.current.scrollTop=w.current.scrollHeight)},[h]);const R=async()=>{var t,N,r,j;i("DEPLOYING"),f(["Initializing deployment sequence...","Validating role permissions..."]),c(null);try{await new Promise(m=>setTimeout(m,500)),f(m=>[...m,"Sending deployment trigger to backend..."]);const{data:s}=await b.post("/deployment/deploy");s.logs&&Array.isArray(s.logs)&&f(m=>[...m,...s.logs]),f(m=>[...m,"Deployment Command Completed Successfully."]),i("SUCCESS")}catch(s){console.error(s);const m=((N=(t=s.response)==null?void 0:t.data)==null?void 0:N.message)||s.message||"Unknown error occurred";c(m),(j=(r=s.response)==null?void 0:r.data)!=null&&j.logs&&Array.isArray(s.response.data.logs)&&f(y=>[...y,...s.response.data.logs]),f(y=>[...y,`CRITICAL FAIL: ${m}`]),i("ERROR")}},u=()=>{o!=="DEPLOYING"&&(i("IDLE"),f([]),c(null),g())};return e.jsx(B,{open:n,onOpenChange:t=>!t&&u(),children:e.jsx(K,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{size:18,className:"text-purple-600"}),"Update Online System"]}),className:"max-w-2xl",hideDraggableBar:!1,children:e.jsxs("div",{className:"p-6 pt-0 space-y-4",children:[e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/10 p-4 rounded-lg border border-purple-100 dark:border-purple-800",children:[e.jsxs("h3",{className:"font-semibold text-purple-900 dark:text-purple-300 flex items-center gap-2",children:[e.jsx(Z,{size:16})," Admin Zone: Production Deployment"]}),e.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-400 mt-1",children:"This action will push your local code to the repo and trigger an update on the live VPS (66.116.224.221). The system may be briefly unavailable during restart."})]}),e.jsxs("div",{className:"bg-slate-950 rounded-lg border border-slate-800 p-4 font-mono text-xs h-64 overflow-y-auto flex flex-col shadow-inner",ref:w,children:[h.length===0&&o==="IDLE"&&e.jsx("div",{className:"text-slate-500 italic my-auto text-center",children:"Ready to deploy. Waiting for confirmation..."}),h.map((t,N)=>e.jsxs("div",{className:"text-slate-300 border-b border-slate-900/50 pb-0.5 mb-0.5 last:border-0 last:mb-0 break-all",children:[e.jsxs("span",{className:"text-slate-600 mr-2",children:["[",new Date().toLocaleTimeString(),"]"]}),t]},N)),o==="DEPLOYING"&&e.jsx("div",{className:"text-purple-400 animate-pulse mt-2",children:"Processing..."})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{className:"text-sm",children:[o==="SUCCESS"&&e.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-2",children:[e.jsx(ce,{size:16})," Update Complete"]}),o==="ERROR"&&e.jsxs("span",{className:"text-red-600 font-medium flex items-center gap-2",children:[e.jsx(oe,{size:16})," Update Failed"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:u,disabled:o==="DEPLOYING",className:"px-4 py-2 text-sm text-muted-foreground hover:text-foreground disabled:opacity-50",children:o==="SUCCESS"?"Close":"Cancel"}),o!=="SUCCESS"&&e.jsxs("button",{onClick:R,disabled:o==="DEPLOYING",className:"px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-md text-sm font-medium shadow-sm transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:[o==="DEPLOYING"?e.jsx(xe,{size:16,className:"animate-spin"}):e.jsx(q,{size:16}),o==="DEPLOYING"?"Deploying...":o==="ERROR"?"Retry Update":"Start Update"]})]})]})]})})})},M=()=>{var u,t,N,r,j;const{user:n}=O(),g=G(),[o,i]=p.useState(!1),{data:h,isLoading:f}=P({queryKey:["dashboard-stats-v2"],queryFn:async()=>{const{data:s}=await b.get("/tasks/stats");return s}});if(f)return e.jsx("div",{className:"p-8 text-center text-gray-500 animate-pulse",children:"Loading dashboard elements..."});const{data:x,isLoading:c}=P({queryKey:["creative-dashboard"],queryFn:async()=>(await b.get("/analytics/creative-dashboard")).data}),{distribution:w,efficiency:R}=h||{distribution:[],efficiency:[]};return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Marketing & SEO Overview"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Real-time insights into team performance and task distribution."})]}),(n==null?void 0:n.role)==="DEVELOPER_ADMIN"&&e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors shadow-sm text-sm font-medium",children:[e.jsx(q,{size:16}),"Update Online System"]})]}),e.jsx(he,{isOpen:o,onClose:()=>i(!1)}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs(C,{className:"border shadow-lg rounded-xl overflow-hidden bg-white",children:[e.jsx(S,{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-4 px-6",children:e.jsxs(T,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(H,{size:20}),"Creative Tasks Assigned Today"]})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"w-[80px] font-bold",children:"S.No"}),e.jsx(l,{className:"font-bold",children:"Staff Name"}),e.jsx(l,{className:"font-bold",children:"Client"}),e.jsx(l,{className:"font-bold",children:"Task Type"}),e.jsx(l,{className:"font-bold",children:"Assigned By"})]})}),e.jsx(k,{children:c?e.jsx(d,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground animate-pulse font-medium",children:"Synchronizing today's assignments..."})}):((u=x==null?void 0:x.dailyTasks)==null?void 0:u.length)===0?e.jsx(d,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground italic font-medium",children:"No new creative tasks assigned yet today."})}):(t=x==null?void 0:x.dailyTasks)==null?void 0:t.map(s=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"font-semibold text-gray-500",children:s.s_no}),e.jsx(a,{className:"font-bold text-gray-900",children:s.staff_name}),e.jsx(a,{className:"font-bold text-indigo-600",children:s.client_name}),e.jsx(a,{children:e.jsx(A,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-100 font-bold",children:s.task_type})}),e.jsx(a,{className:"text-gray-600 font-medium",children:s.assigned_by})]},s.id))})]})})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(S,{className:"bg-emerald-600 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(T,{className:"text-sm font-bold",children:"Today's Efficiency"}),e.jsx(X,{size:16})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-xs font-bold uppercase",children:"Member"}),e.jsx(l,{className:"text-xs font-bold text-right uppercase",children:"Score"})]})}),e.jsx(k,{children:(N=x==null?void 0:x.dailyEfficiency)==null?void 0:N.map(s=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"text-sm font-bold text-gray-700",children:s.staff_name}),e.jsx(a,{className:"text-right",children:e.jsxs(A,{className:`${s.efficiency>=80?"bg-green-100 text-green-700 border-green-200":s.efficiency>=50?"bg-amber-100 text-amber-700 border-amber-200":"bg-red-100 text-red-700 border-red-200"} font-black text-xs px-2`,children:[s.efficiency,"%"]})})]},s.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(S,{className:"bg-cyan-600 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(T,{className:"text-sm font-bold",children:"Weekly Performance"}),e.jsx(Y,{size:16})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-xs font-bold uppercase",children:"Member"}),e.jsx(l,{className:"text-xs font-bold text-right uppercase",children:"Avg"})]})}),e.jsx(k,{children:(r=x==null?void 0:x.weeklyEfficiency)==null?void 0:r.map(s=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"text-sm font-bold text-gray-700",children:s.staff_name}),e.jsx(a,{className:"text-right",children:e.jsx("span",{className:`inline-flex items-center justify-center w-8 h-8 rounded-full font-black text-xs ${s.efficiency>=80?"bg-green-600 text-white":s.efficiency>=50?"bg-cyan-600 text-white":"bg-slate-400 text-white shadow-inner uppercase"}`,children:s.efficiency})})]},s.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(S,{className:"bg-rose-600 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(T,{className:"text-sm font-bold",children:"Monthly Efficacy"}),e.jsx(W,{size:18})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-xs font-bold uppercase",children:"Member"}),e.jsx(l,{className:"text-xs font-bold text-right uppercase",children:"Progress"})]})}),e.jsx(k,{children:(j=x==null?void 0:x.monthlyEfficiency)==null?void 0:j.map(s=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"text-sm font-bold text-gray-700",children:s.staff_name}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("span",{className:"text-[10px] font-black text-rose-600 leading-none",children:[s.efficiency,"%"]}),e.jsx("div",{className:"w-16 h-2 bg-gray-100 rounded-full overflow-hidden shadow-inner border border-gray-200",children:e.jsx("div",{className:"h-full bg-rose-500 shadow-sm",style:{width:`${s.efficiency}%`}})})]})})]},s.id))})]})})})]})]}),e.jsxs("div",{onClick:()=>g("/dashboard/client-portal/manage-services"),className:"bg-white p-6 rounded-xl shadow-lg border-2 border-dashed border-indigo-200 hover:border-indigo-400 hover:bg-indigo-50/30 transition-all cursor-pointer flex items-center justify-between group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-indigo-100 rounded-2xl text-indigo-600 group-hover:scale-110 transition-transform shadow-sm",children:e.jsx(z,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 group-hover:text-indigo-700 transition-colors",children:"Lead Management & Campaign History"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Track daily leads, follow-ups, and active service performances."})]})]}),e.jsxs("div",{className:"mr-4 text-indigo-600 font-black flex items-center gap-2 group-hover:translate-x-1 transition-transform",children:["Open Manager ",e.jsx(z,{size:20})]})]})]})},$=()=>{var x,c,w,R,u;const{user:n}=O(),{data:g,isLoading:o}=P({queryKey:["designer-stats"],queryFn:async()=>{const{data:t}=await b.get("/tasks/stats");return t}});if(o)return e.jsx("div",{className:"p-8 text-center text-gray-500 animate-pulse",children:"Loading workspace..."});const{data:i,isLoading:h}=P({queryKey:["creative-dashboard"],queryFn:async()=>(await b.get("/analytics/creative-dashboard")).data}),{distribution:f}=g||{distribution:[]};return g!=null&&g.efficiency[0],e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent",children:"My Creative Space"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track your tasks and performance."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs(C,{className:"border shadow-lg rounded-xl overflow-hidden bg-white",children:[e.jsx(S,{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 px-6",children:e.jsxs(T,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(H,{size:20}),"My Team's Tasks Assigned Today"]})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"w-[80px] font-bold",children:"S.No"}),e.jsx(l,{className:"font-bold",children:"Staff Name"}),e.jsx(l,{className:"font-bold",children:"Client"}),e.jsx(l,{className:"font-bold",children:"Task Type"}),e.jsx(l,{className:"font-bold",children:"Assigned By"})]})}),e.jsx(k,{children:h?e.jsx(d,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground animate-pulse font-medium text-sm",children:"Refreshing creative assignments..."})}):((x=i==null?void 0:i.dailyTasks)==null?void 0:x.length)===0?e.jsx(d,{children:e.jsx(a,{colSpan:5,className:"h-32 text-center text-muted-foreground italic font-medium text-sm",children:"No tasks assigned to your team yet today."})}):(c=i==null?void 0:i.dailyTasks)==null?void 0:c.map(t=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"font-semibold text-gray-400",children:t.s_no}),e.jsx(a,{className:"font-bold text-gray-800",children:t.staff_name}),e.jsx(a,{className:"font-bold text-orange-600",children:t.client_name}),e.jsx(a,{children:e.jsx(A,{className:"bg-orange-50 text-orange-700 border-orange-100 font-bold",variant:"outline",children:t.task_type})}),e.jsx(a,{className:"text-gray-500 font-medium",children:t.assigned_by})]},t.id))})]})})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(S,{className:"bg-amber-500 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(T,{className:"text-sm font-bold",children:"Daily Scorecard"}),e.jsx(X,{size:18})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-xs font-bold uppercase",children:"Staff"}),e.jsx(l,{className:"text-xs font-bold text-right uppercase",children:"Efficiency"})]})}),e.jsx(k,{children:(w=i==null?void 0:i.dailyEfficiency)==null?void 0:w.map(t=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs(a,{className:`text-sm font-bold ${t.id===(n==null?void 0:n.id)?"text-orange-600":"text-gray-600"}`,children:[t.staff_name," ",t.id===(n==null?void 0:n.id)&&"(Me)"]}),e.jsx(a,{className:"text-right",children:e.jsxs(A,{className:`${t.efficiency>=80?"bg-green-100 text-green-700 border-green-200":t.efficiency>=50?"bg-orange-100 text-orange-700 border-orange-200":"bg-red-100 text-red-700 border-red-200"} font-black text-xs`,children:[t.efficiency,"%"]})})]},t.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(S,{className:"bg-blue-500 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(T,{className:"text-sm font-bold",children:"Weekly Performance"}),e.jsx(Y,{size:18})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-xs font-bold uppercase",children:"Staff"}),e.jsx(l,{className:"text-xs font-bold text-right uppercase",children:"Rank"})]})}),e.jsx(k,{children:(R=i==null?void 0:i.weeklyEfficiency)==null?void 0:R.map(t=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:`text-sm font-bold ${t.id===(n==null?void 0:n.id)?"text-blue-600":"text-gray-600"}`,children:t.staff_name}),e.jsx(a,{className:"text-right",children:e.jsx("span",{className:`inline-flex items-center justify-center w-8 h-8 rounded-full font-black text-xs ${t.efficiency>=80?"bg-green-500 text-white shadow-sm":t.efficiency>=50?"bg-blue-500 text-white shadow-sm":"bg-slate-300 text-white shadow-inner"}`,children:t.efficiency})})]},t.id))})]})})})]}),e.jsxs(C,{className:"border shadow-md rounded-xl overflow-hidden bg-white",children:[e.jsxs(S,{className:"bg-indigo-500 text-white py-3 px-4 flex flex-row items-center justify-between",children:[e.jsx(T,{className:"text-sm font-bold",children:"Monthly Efficacy"}),e.jsx(W,{size:20})]}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-xs font-bold uppercase",children:"Staff"}),e.jsx(l,{className:"text-xs font-bold text-right uppercase",children:"Track"})]})}),e.jsx(k,{children:(u=i==null?void 0:i.monthlyEfficiency)==null?void 0:u.map(t=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:`text-sm font-bold ${t.id===(n==null?void 0:n.id)?"text-indigo-600":"text-gray-600"}`,children:t.staff_name}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("span",{className:"text-[10px] font-black text-indigo-600 leading-none",children:[t.efficiency,"%"]}),e.jsx("div",{className:"w-16 h-2 bg-gray-100 rounded-full overflow-hidden shadow-inner border border-gray-100",children:e.jsx("div",{className:`h-full ${t.id===(n==null?void 0:n.id)?"bg-indigo-600 shadow-md":"bg-indigo-400 opacity-60"}`,style:{width:`${t.efficiency}%`}})})]})})]},t.id))})]})})})]})]})]})},J=p.forwardRef(({className:n,children:g,...o},i)=>e.jsx("div",{ref:i,className:se("relative overflow-auto",n),...o,children:g}));J.displayName="ScrollArea";const ge=({trigger:n,highlightId:g,autoOpen:o,onOpenChange:i})=>{const[h,f]=p.useState([]),[x,c]=p.useState(!1),w=r=>{c(r),i&&i(r)},[R,u]=p.useState(!1);p.useEffect(()=>{(g||o)&&c(!0)},[g,o]),p.useEffect(()=>{x&&g&&h.length>0&&setTimeout(()=>{const r=document.getElementById(`request-${g}`);r&&(r.scrollIntoView({behavior:"smooth",block:"center"}),r.classList.add("ring-2","ring-primary"))},500)},[x,g,h]);const t=async()=>{u(!0);try{const[r,j]=await Promise.all([b.get("/leave/requests"),b.get("/attendance/regularisation/requests?status=PENDING")]),s=r.data.map(y=>({...y,category:"LEAVE"})),m=j.data.map(y=>({...y,category:"REGULARISATION"}));f([...s,...m].sort((y,_)=>new Date(_.createdAt).getTime()-new Date(y.createdAt).getTime()))}catch(r){console.error("Failed to fetch requests",r)}finally{u(!1)}};p.useEffect(()=>{x&&t()},[x]);const N=async(r,j,s)=>{try{const m=j==="LEAVE"?`/leave/${r}/status`:`/attendance/regularisation/${r}/status`;await b.patch(m,{status:s}),t()}catch(m){console.error("Failed to update status",m),alert("Failed to process request.")}};return e.jsxs(B,{open:x,onOpenChange:w,children:[e.jsx(te,{asChild:!0,children:n}),e.jsxs(K,{className:"sm:max-w-[600px] h-[80vh] flex flex-col p-0 gap-0",children:[e.jsx(ae,{className:"p-6 pb-2 border-b border-border",children:e.jsxs(re,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5 text-primary"}),"Pending Approvals",e.jsx(A,{variant:"secondary",className:"ml-2",children:h.length})]})}),e.jsx(J,{className:"flex-1 p-6 pt-2",children:R?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading requests..."}):h.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(U,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"All caught up! No pending requests."})]}):e.jsx("div",{className:"space-y-4 pt-4",children:h.map(r=>{var j,s,m,y,_;return e.jsxs("div",{id:`request-${r.id}`,className:"border rounded-lg p-4 bg-card shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold",children:((s=(j=r.user)==null?void 0:j.full_name)==null?void 0:s.charAt(0))||e.jsx(le,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:(m=r.user)==null?void 0:m.full_name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[(y=r.user)==null?void 0:y.department," â€¢ ",(_=r.user)==null?void 0:_.role]})]})]}),e.jsx(A,{variant:r.category==="LEAVE"?"default":"outline",className:r.category==="LEAVE"?"bg-primary/20 text-primary hover:bg-primary/30 border-primary/20":"text-blue-500 border-blue-500/50",children:r.category==="LEAVE"?"Leave Application":"Attendance Regularisation"})]}),e.jsxs("div",{className:"ml-12 space-y-2 mb-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs block mb-1",children:"Type"}),e.jsx("span",{className:"font-medium",children:r.type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs block mb-1",children:"Dates"}),r.category==="LEAVE"?e.jsxs("span",{className:"font-medium",children:[new Date(r.start_date).toLocaleDateString()," - ",new Date(r.end_date).toLocaleDateString()]}):e.jsx("span",{className:"font-medium",children:new Date(r.date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"bg-muted/50 p-2 rounded text-sm text-muted-foreground",children:[e.jsx(ne,{className:"h-3 w-3 inline mr-1"}),r.reason]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2 border-t mt-2",children:[e.jsxs(D,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 border-destructive/20",onClick:()=>N(r.id,r.category,"REJECTED"),children:[e.jsx(ie,{className:"h-4 w-4 mr-1"})," Reject"]}),e.jsxs(D,{size:"sm",className:"bg-green-600 dark:bg-green-700 hover:bg-green-700 dark:hover:bg-green-600 text-white",onClick:()=>N(r.id,r.category,"APPROVED"),children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Approve"]})]})]},r.id)})})})]})]})},fe=()=>{const[n,g]=p.useState(document.documentElement.classList.contains("dark"));return p.useEffect(()=>{const o=new MutationObserver(i=>{i.forEach(h=>{h.attributeName==="class"&&g(document.documentElement.classList.contains("dark"))})});return o.observe(document.documentElement,{attributes:!0}),()=>o.disconnect()},[]),n},V=()=>{var u,t,N,r,j;const{user:n}=O();G(),fe();const[g,o]=Q(),i=g.get("requestId"),{data:h}=P({queryKey:["creative-metrics"],queryFn:async()=>(await b.get("/analytics/creative-metrics")).data}),{data:f}=P({queryKey:["attendance-stats"],queryFn:async()=>(await b.get("/analytics/attendance")).data}),{data:x}=P({queryKey:["team-performance"],queryFn:async()=>(await b.get("/analytics/team-performance")).data}),{data:c,isLoading:w}=P({queryKey:["creative-dashboard"],queryFn:async()=>(await b.get("/analytics/creative-dashboard")).data}),{data:R}=P({queryKey:["pending-requests-count"],queryFn:async()=>{const[s,m]=await Promise.all([b.get("/leave/requests"),b.get("/attendance/regularisation/requests?status=PENDING")]);return s.data.filter(_=>_.status==="PENDING").length+m.data.length},refetchInterval:3e4});return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 py-4 border-b",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-foreground",children:"Overview"})}),e.jsx("div",{className:"flex items-center gap-6",children:e.jsx(ge,{highlightId:i,autoOpen:!!i||g.get("action")==="review_request",onOpenChange:s=>{if(!s&&(i||g.get("action"))){const m=new URLSearchParams(g);m.delete("requestId"),m.delete("type"),m.delete("action"),o(m)}},trigger:e.jsxs(D,{variant:"outline",className:"gap-2 shadow-sm border-orange-200 bg-orange-50/50 hover:bg-orange-50 text-orange-700 relative",children:[e.jsx(de,{className:"h-4 w-4"}),"Pending Requests",R>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 rounded-full bg-red-500 animate-pulse ring-2 ring-white"})]})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:f==null?void 0:f.map(s=>e.jsxs("div",{className:`p-6 rounded-xl shadow-sm hover:shadow-md transition-all ${s.styles.card}`,children:[e.jsx("h3",{className:`text-xs font-bold uppercase tracking-wider mb-2 ${s.styles.label}`,children:s.department}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:`text-4xl font-extrabold ${s.styles.value}`,children:s.count}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm ${s.styles.text}`,children:"Present"})]})]},s.department))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-purple-50 dark:bg-purple-900/10 border border-purple-100 dark:border-purple-900/20",children:[e.jsx("h3",{className:"text-sm font-semibold text-purple-700 dark:text-purple-300",children:"Total Assigned"}),e.jsx("p",{className:"text-3xl font-bold mt-1 text-purple-900 dark:text-purple-100",children:(h==null?void 0:h.total)||0})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-green-50 dark:bg-green-900/10 border border-green-100 dark:border-green-900/20",children:[e.jsx("h3",{className:"text-sm font-semibold text-green-700 dark:text-green-300",children:"Completed"}),e.jsx("p",{className:"text-3xl font-bold mt-1 text-green-900 dark:text-green-100",children:(h==null?void 0:h.completed)||0})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/20",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-700 dark:text-blue-300",children:"In Progress"}),e.jsx("p",{className:"text-3xl font-bold mt-1 text-blue-900 dark:text-blue-100",children:(h==null?void 0:h.wip)||0})]})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(C,{className:"border shadow-sm h-full rounded-xl overflow-hidden",children:[e.jsx(S,{className:"bg-gray-50/50 py-3 px-4 border-b",children:e.jsxs(T,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(A,{variant:"outline",className:"bg-indigo-100 text-indigo-700 border-indigo-200",children:"New"}),"Creative Tasks Assigned Today"]})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50/30",children:e.jsxs(d,{children:[e.jsx(l,{className:"w-[80px] text-sm font-bold",children:"S.No"}),e.jsx(l,{className:"text-sm font-bold",children:"Staff Name"}),e.jsx(l,{className:"text-sm font-bold",children:"Client"}),e.jsx(l,{className:"text-sm font-bold",children:"Task Type"}),e.jsx(l,{className:"text-sm font-bold",children:"Assigned By"})]})}),e.jsx(k,{children:w?e.jsx(d,{children:e.jsx(a,{colSpan:5,className:"h-24 text-center text-sm text-muted-foreground animate-pulse",children:"Loading today's tasks..."})}):((u=c==null?void 0:c.dailyTasks)==null?void 0:u.length)===0?e.jsx(d,{children:e.jsx(a,{colSpan:5,className:"h-24 text-center text-sm text-muted-foreground italic",children:"No tasks assigned yet today."})}):(t=c==null?void 0:c.dailyTasks)==null?void 0:t.map(s=>e.jsxs(d,{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsx(a,{className:"text-sm font-medium text-gray-500",children:s.s_no}),e.jsx(a,{className:"text-sm font-bold text-gray-900",children:s.staff_name}),e.jsx(a,{className:"text-sm font-medium text-indigo-600",children:s.client_name}),e.jsx(a,{className:"text-sm font-medium",children:e.jsx(A,{variant:"outline",className:"text-xs font-bold py-0",children:s.task_type})}),e.jsx(a,{className:"text-sm text-gray-600",children:s.assigned_by})]},s.id))})]})})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"border shadow-sm rounded-xl overflow-hidden",children:[e.jsx(S,{className:"bg-indigo-600 text-white py-3 px-4",children:e.jsx(T,{className:"text-base font-bold",children:"Task Efficiency (Daily)"})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50/50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-sm font-bold",children:"Staff"}),e.jsx(l,{className:"text-sm font-bold text-center",children:"Assigned"}),e.jsx(l,{className:"text-sm font-bold text-center",children:"Completed"}),e.jsx(l,{className:"text-sm font-bold text-right",children:"Efficiency"})]})}),e.jsx(k,{children:(N=c==null?void 0:c.dailyEfficiency)==null?void 0:N.map(s=>e.jsxs(d,{className:"hover:bg-gray-50/50",children:[e.jsx(a,{className:"text-sm font-semibold",children:s.staff_name}),e.jsx(a,{className:"text-sm font-semibold text-center text-gray-600",children:s.assigned}),e.jsx(a,{className:"text-sm font-semibold text-center text-green-600",children:s.completed}),e.jsx(a,{className:"text-right",children:e.jsxs(A,{className:`${s.efficiency>=80?"bg-green-100 text-green-700":s.efficiency>=50?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"} text-xs font-bold`,children:[s.efficiency,"%"]})})]},s.id))})]})})})]}),e.jsxs(C,{className:"border shadow-sm rounded-xl overflow-hidden",children:[e.jsx(S,{className:"bg-blue-600 text-white py-3 px-4",children:e.jsx(T,{className:"text-base font-bold",children:"Weekly Performance"})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50/50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-sm font-bold",children:"Staff"}),e.jsx(l,{className:"text-sm font-bold text-center",children:"Assigned"}),e.jsx(l,{className:"text-sm font-bold text-center",children:"Completed"}),e.jsx(l,{className:"text-sm font-bold text-right",children:"Efficiency"})]})}),e.jsx(k,{children:(r=c==null?void 0:c.weeklyEfficiency)==null?void 0:r.map(s=>e.jsxs(d,{className:"hover:bg-gray-50/50",children:[e.jsx(a,{className:"text-sm font-semibold",children:s.staff_name}),e.jsx(a,{className:"text-sm font-semibold text-center text-gray-600",children:s.assigned}),e.jsx(a,{className:"text-sm font-semibold text-center text-green-600",children:s.completed}),e.jsx(a,{className:"text-right",children:e.jsxs(A,{className:`${s.efficiency>=80?"bg-green-500 text-white":s.efficiency>=50?"bg-blue-500 text-white":"bg-gray-400 text-white"} text-xs font-bold`,children:[s.efficiency,"%"]})})]},s.id))})]})})})]}),e.jsxs(C,{className:"border shadow-sm rounded-xl overflow-hidden",children:[e.jsx(S,{className:"bg-purple-600 text-white py-3 px-4",children:e.jsx(T,{className:"text-base font-bold",children:"Monthly Performance"})}),e.jsx(L,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(v,{children:[e.jsx(E,{className:"bg-gray-50/50",children:e.jsxs(d,{children:[e.jsx(l,{className:"text-sm font-bold",children:"Staff"}),e.jsx(l,{className:"text-sm font-bold text-center",children:"Assigned"}),e.jsx(l,{className:"text-sm font-bold text-center",children:"Completed"}),e.jsx(l,{className:"text-sm font-bold text-right",children:"Efficiency"})]})}),e.jsx(k,{children:(j=c==null?void 0:c.monthlyEfficiency)==null?void 0:j.map(s=>e.jsxs(d,{className:"hover:bg-gray-50/50",children:[e.jsx(a,{className:"text-sm font-semibold",children:s.staff_name}),e.jsx(a,{className:"text-sm font-semibold text-center text-gray-600",children:s.assigned}),e.jsx(a,{className:"text-sm font-semibold text-center text-green-600",children:s.completed}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-600",children:[s.efficiency,"%"]}),e.jsx("div",{className:"w-12 h-1.5 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500",style:{width:`${s.efficiency}%`}})})]})})]},s.id))})]})})})]})]})]})},Ce=()=>{const{user:n}=O();if(!n)return null;if(n.role===I.CLIENT)return e.jsx(ee,{to:"/dashboard/client-portal",replace:!0});switch(n.role){case I.DEVELOPER_ADMIN:case I.ADMIN:case I.MANAGER:return e.jsx(V,{});case I.DM_EXECUTIVE:case I.MARKETING_EXEC:case I.WEB_SEO_EXECUTIVE:case I.OPERATIONS_EXECUTIVE:return e.jsx(M,{});case I.CREATIVE_DESIGNER:return e.jsx($,{});default:return n.role.includes("DESIGNER")?e.jsx($,{}):n.role.includes("EXECUTIVE")?e.jsx(M,{}):n.role.includes("ADMIN")||n.role.includes("MANAGER")?e.jsx(V,{}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsxs("h3",{className:"text-xl font-bold mb-2",children:["Welcome, ",n.full_name]}),e.jsxs("p",{children:["Dashboard view not configured for role: ",n.role]})]})}};export{Ce as default};
