import{v as A,a as L,q as k,u as D,r as I,x as c,j as e}from"./index-_K9dBzXA.js";import{C as M}from"./card-BJXC2BmV.js";import{u as h,i as O,S as y,$ as T,B as q,p as $,T as G,a0 as B}from"./index-C0_MxDCy.js";import{A as j}from"./activity-BIVplPpj.js";import{P}from"./pen-tool-BS_U9yd4.js";import{L as z}from"./layout-dashboard-BlNWEKgk.js";import{G as F}from"./globe-E2cIpeby.js";/**
 * @license lucide-react v0.331.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=A("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),f={META_ADS:{title:"Meta Ads",icon:G,path:"/dashboard/client-portal/meta-ads"},GOOGLE_ADS:{title:"Google Ads",icon:$,path:"/dashboard/client-portal/google-ads"},SEO:{title:"SEO",icon:F,path:"/dashboard/client-portal/seo"},WEB_DEV:{title:"Web Development",icon:z,path:"/dashboard/client-portal/web-dev"},CONTENT:{title:"Content Creation",icon:P,path:"/dashboard/client-portal/content"},BRANDING:{title:"Branding",icon:R,path:"/dashboard/client-portal/branding"}},Z=()=>{const N=L(),x=k(),{user:r}=D(),b=(r==null?void 0:r.role)==="ADMIN"||(r==null?void 0:r.role)==="MANAGER"||(r==null?void 0:r.role)==="DEVELOPER_ADMIN",[i,w]=I.useState((r==null?void 0:r.role)==="CLIENT"&&(r==null?void 0:r.linked_client_id)||null),{data:g,isLoading:S}=h({queryKey:["clients-list-simple"],queryFn:async()=>(await c.get("/clients")).data}),{data:s,isLoading:Q}=h({queryKey:["client-manage-services",i],queryFn:async()=>{if(!i)return null;const{data:t}=await c.get(`/clients/${i}`);return t},enabled:!!i}),{data:l,isLoading:V}=h({queryKey:["portal-stats",i],queryFn:async()=>{if(!i)return null;const{data:t}=await c.get(`/client-portal/dashboard?clientId=${i}`);return t},enabled:!!i}),C=O({mutationFn:async({clientId:t,services:a})=>await c.patch(`/clients/${t}`,{service_engagement:a}),onSuccess:()=>{x.invalidateQueries({queryKey:["clients-list-simple"]}),x.invalidateQueries({queryKey:["client-manage-services"]}),x.invalidateQueries({queryKey:["portal-stats"]}),y.fire({title:"Services Updated",icon:"success",toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3})},onError:t=>{var a,n;y.fire("Error",((n=(a=t.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to update services","error")}}),_=t=>{if(!s)return;let a=[];if(Array.isArray(s.service_engagement))a=s.service_engagement;else if(typeof s.service_engagement=="string")try{a=JSON.parse(s.service_engagement)}catch{a=[]}const o=a.includes(t)?a.filter(d=>d!==t):[...a,t];C.mutate({clientId:s.id,services:o})},E=t=>{var a,n,o;if(!l)return null;switch(t){case"META_ADS":const d=l.meta_ads;return d?e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[e.jsxs("div",{className:"bg-white/50 p-1.5 rounded border border-blue-100",children:[e.jsx("div",{className:"text-muted-foreground scale-90 origin-left",children:"Total Spend"}),e.jsxs("div",{className:"font-bold text-blue-700",children:["₹",((a=d.total_spend)==null?void 0:a.toLocaleString())||0]})]}),e.jsxs("div",{className:"bg-white/50 p-1.5 rounded border border-purple-100",children:[e.jsx("div",{className:"text-muted-foreground scale-90 origin-left",children:"Last Campaign"}),e.jsx("div",{className:"font-bold truncate text-purple-700",children:d.last_campaign||"-"})]})]}):null;case"GOOGLE_ADS":const m=l.google_ads;return m?e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[e.jsxs("div",{className:"bg-white/50 p-1.5 rounded border border-orange-100",children:[e.jsx("div",{className:"text-muted-foreground scale-90 origin-left",children:"Total Spend"}),e.jsxs("div",{className:"font-bold text-orange-700",children:["₹",((n=m.total_spend)==null?void 0:n.toLocaleString())||0]})]}),e.jsxs("div",{className:"bg-white/50 p-1.5 rounded border border-yellow-100",children:[e.jsx("div",{className:"text-muted-foreground scale-90 origin-left",children:"Conversions"}),e.jsx("div",{className:"font-bold text-yellow-700",children:m.conversions||0})]})]}):null;case"SEO":const u=l.seo;return u?e.jsxs("div",{className:"mt-2 text-xs bg-white/50 p-1.5 rounded border border-green-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-muted-foreground scale-90 origin-left",children:["Traffic (",u.month,")"]}),e.jsxs("div",{className:"font-bold text-green-700",children:[(o=u.traffic)==null?void 0:o.toLocaleString()," Visits"]})]}),e.jsx(j,{size:14,className:"text-green-500"})]}):null;case"WEB_DEV":const p=l.web_dev;return p?e.jsxs("div",{className:"mt-2 text-xs",children:[e.jsx("div",{className:"font-medium text-gray-700 truncate",children:p.active_project}),e.jsx("div",{className:"flex items-center gap-1 mt-1 text-[10px] uppercase font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded w-fit",children:p.status})]}):null;case"CONTENT":case"BRANDING":const v=l.content;return v?e.jsxs("div",{className:"mt-2 text-xs bg-white/50 p-1.5 rounded border border-pink-100 flex items-center justify-between",children:[e.jsx("span",{className:"text-pink-700 font-medium",children:"Pending Items"}),e.jsx("span",{className:"bg-pink-100 text-pink-700 px-1.5 py-0.5 rounded-full font-bold",children:v.pending_items})]}):null;default:return null}};return S?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading clients..."}):e.jsxs("div",{className:"animate-in fade-in w-full",children:[e.jsxs("div",{className:"bg-yellow-50 border-b border-yellow-200 py-6 px-8 mb-6 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-extrabold tracking-tight text-yellow-900 drop-shadow-sm",children:(r==null?void 0:r.role)==="CLIENT"?"My Services & Portal":"Manage Client Services"}),e.jsx("p",{className:"text-yellow-700/80 mt-1 font-medium",children:(r==null?void 0:r.role)==="CLIENT"?"Monitor your active services, analytics and reports.":"Configure active services and monitor tracking overviews."})]}),b&&e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsxs("select",{className:"w-full h-12 pl-5 pr-12 rounded-xl border-2 border-purple-200 bg-purple-50 text-purple-900 font-bold text-lg ring-offset-background focus-visible:outline-none focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all appearance-none cursor-pointer hover:bg-purple-100",onChange:t=>w(t.target.value||null),value:i||"",children:[e.jsx("option",{value:"",children:"-- Select A Client --"}),g==null?void 0:g.sort((t,a)=>t.name.localeCompare(a.name)).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("div",{className:"absolute right-2 top-2 h-8 w-8 bg-purple-200 rounded-lg flex items-center justify-center pointer-events-none text-purple-700",children:e.jsx(T,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"px-8 pb-8",children:i&&s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.logo_url?e.jsx("img",{src:s.logo_url.startsWith("http")?s.logo_url:`${"/api".replace("/api","")||"http://localhost:4000"}${s.logo_url}`,className:"w-16 h-16 rounded-full border-2 border-gray-100 object-cover shadow-sm"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold text-2xl shadow-md",children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-sm px-2 py-0.5 bg-gray-100 text-gray-600 rounded font-mono",children:["ID: ",s.client_code||"N/A"]}),s.industry&&e.jsx("span",{className:"text-sm px-2 py-0.5 bg-blue-50 text-blue-700 rounded",children:s.industry})]})]}),e.jsx("div",{className:"ml-auto flex gap-3",children:e.jsxs(q,{onClick:()=>N(`/dashboard/client-portal/manage-services${i?"?clientId="+i:""}`),className:"bg-indigo-600 text-white font-extrabold px-8 h-14 text-lg rounded-xl flex items-center gap-2 border-2 border-yellow-400 border-b-[6px] hover:border-b-2 hover:translate-y-1 shadow-xl transition-all ring-4 ring-yellow-400/30",children:[e.jsx(j,{size:24})," Manage Services"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Object.keys(f).map(t=>{let a=[];if(Array.isArray(s.service_engagement))a=s.service_engagement;else if(typeof s.service_engagement=="string")try{a=JSON.parse(s.service_engagement)}catch{}const n=a.includes(t),o=f[t].icon;return e.jsx(M,{className:`flex flex-col border-2 transition-all duration-200 overflow-hidden ${n?"bg-gradient-to-b from-white to-gray-50 border-gray-200 shadow-sm hover:shadow-md hover:border-gray-300":"bg-gray-50/50 border-dashed border-gray-200 opacity-70 hover:opacity-100"}`,children:e.jsxs("div",{className:"p-5 flex-1 relative",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg shadow-sm ${n?"bg-indigo-600 text-white":"bg-gray-200 text-gray-400"}`,children:e.jsx(o,{size:20})}),e.jsx("div",{children:e.jsx("h4",{className:`font-bold text-base ${n?"text-gray-900":"text-gray-500"}`,children:f[t].title})})]}),b&&e.jsx("div",{onClick:()=>_(t),className:`cursor-pointer w-10 h-6 rounded-full flex items-center transition-colors p-1 ${n?"bg-green-500 justify-end":"bg-gray-300 justify-start"}`,children:e.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]}),e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-sm ${n?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:n?"Active":"Inactive"})}),n&&l?e.jsx("div",{className:"min-h-[60px]",children:E(t)}):e.jsx("div",{className:"min-h-[60px] flex items-center justify-center text-xs text-gray-400 italic",children:n?"Loading stats...":"Enable to track data"})]})},t)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-20 bg-gray-50/50 rounded-xl border-2 border-dashed border-gray-200 h-[60vh]",children:[e.jsx("div",{className:"bg-white p-6 rounded-full shadow-lg mb-6 text-purple-200",children:e.jsx(B,{size:48})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Start Here"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md mt-2",children:"Select a client from the purple menu above to begin managing their services."})]})})]})};export{Z as default};
