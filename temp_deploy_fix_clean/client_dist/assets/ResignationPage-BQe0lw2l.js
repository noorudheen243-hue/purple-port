import{j as e,q as H,x as v,E as se,r as f,u as te}from"./index-_K9dBzXA.js";import{j as b,C as F,a3 as ae,a1 as ie,a4 as re,a6 as ne,i as w,D as J,a as K,d as Q,e as Y,am as le,a7 as L,u as B,B as p,L as O,F as W,g as z,J as de,I as oe,X as ce,l as me,f as xe,R as M,U as ue}from"./index-C0_MxDCy.js";import{C as pe,a as ge,b as he,c as je}from"./card-BJXC2BmV.js";import{B as X}from"./badge-BRRI9-vD.js";import{C as P}from"./clock-89fNMNOB.js";import{A as fe}from"./alert-circle-Dgl9YWib.js";import{X as ve}from"./x-circle-DJEckX6R.js";import{L as A}from"./loader-2-m9uN2hHg.js";import{T as ye,a as Ne,b as k,c as D,d as be,e as N}from"./table-CZtgpgQ3.js";import{S as De,a as we,b as _e,c as Re,d as E}from"./select-BsM-SyXO.js";import{S as Ee}from"./save-BPR9f-BE.js";import{P as Ce}from"./pen-CBlSZq_l.js";import{T as Te,a as Se,b as U,c as $}from"./tabs-BB7NwzE5.js";import"./index-feRhg8F5.js";import"./index-I-cGsQdO.js";import"./index-CemV9wER.js";const Me=t=>{switch(t){case"APPLIED":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"UNDER_NOTICE":return"bg-blue-100 text-blue-800 border-blue-200";case"COMPLETED":return"bg-green-100 text-green-800 border-green-200";case"REJECTED":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800"}},Pe=({data:t})=>t?e.jsxs(pe,{className:"max-w-2xl mx-auto border-t-4 border-t-primary shadow-sm",children:[e.jsxs(ge,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(he,{className:"text-lg font-bold flex items-center gap-2",children:"Resignation Status"}),e.jsx(X,{variant:"outline",className:`${Me(t.status)} px-3 py-1`,children:t.status.replace("_"," ")})]}),e.jsxs(je,{className:"grid gap-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground uppercase font-bold",children:"Applied On"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(F,{size:16,className:"text-muted-foreground"}),b(new Date(t.applied_date),"dd MMM yyyy")]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground uppercase font-bold",children:"Relieving Date"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(F,{size:16,className:"text-muted-foreground"}),b(new Date(t.approved_relieving_date||t.requested_relieving_date),"dd MMM yyyy"),t.status==="APPLIED"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(Req)"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground uppercase font-bold",children:"Notice Period"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(P,{size:16,className:"text-muted-foreground"}),(()=>{const n=new Date(t.approved_relieving_date||t.requested_relieving_date),d=new Date(t.applied_date),m=n.getTime()-d.getTime();return`${Math.ceil(m/(1e3*60*60*24))} Days`})()]})]}),e.jsxs("div",{className:"space-y-1 col-span-2 md:col-span-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground uppercase font-bold",children:"Days Left"}),e.jsxs("div",{className:"flex items-center gap-2 text-xl font-bold text-primary",children:[e.jsx(P,{size:20}),(()=>{const n=new Date(t.approved_relieving_date||t.requested_relieving_date),d=new Date;d.setHours(0,0,0,0);const m=n.getTime()-d.getTime(),g=Math.ceil(m/(1e3*60*60*24));return g>0?`${g} Days`:"Passed"})()]})]})]}),e.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg border border-border",children:[t.status==="APPLIED"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx(fe,{className:"text-yellow-600 shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Application Received"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Your resignation request is pending manager review. The notice period countdown will begin once designated."})]})]}),t.status==="UNDER_NOTICE"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx(P,{className:"text-blue-600 shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Under Notice Period"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["You are currently serving your notice period. Please ensure all handover tasks are completed by ",e.jsx("strong",{children:b(new Date(t.approved_relieving_date),"dd MMM yyyy")}),"."]})]})]}),t.status==="COMPLETED"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ae,{className:"text-green-600 shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Relieved Successfully"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Your resignation process is complete. We wish you the best in your future endeavors!"})]})]}),t.status==="REJECTED"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ve,{className:"text-red-600 shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Request Rejected"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Reason: ",e.jsx("span",{className:"italic",children:t.rejection_reason||"No reason provided."})]})]})]})]})]})]}):null,ke=ne({requested_relieving_date:L().refine(t=>!isNaN(Date.parse(t)),{message:"Invalid date"}),reason:L().min(5,"Reason must be at least 5 characters"),confirm:le().refine(t=>t===!0,"You must acknowledge the policy")}),Ae=({isOpen:t,onClose:n})=>{const d=H(),m=new Date;m.setDate(m.getDate()+30);const g=m.toISOString().split("T")[0],{register:l,handleSubmit:x,formState:{errors:r},reset:h}=ie({resolver:re(ke),defaultValues:{requested_relieving_date:g,reason:"",confirm:!1}}),c=w({mutationFn:async o=>await v.post("/team/resignation/apply",{requested_relieving_date:o.requested_relieving_date,reason:o.reason}),onSuccess:()=>{d.invalidateQueries({queryKey:["my-resignation"]}),h(),n(),alert("Resignation request submitted successfully.")},onError:o=>{var u,R;alert(((R=(u=o.response)==null?void 0:u.data)==null?void 0:R.message)||"Failed to submit request.")}});return e.jsx(J,{open:t,onOpenChange:n,children:e.jsxs(K,{className:"max-w-md bg-background text-foreground",children:[e.jsx(Q,{children:e.jsxs(Y,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(se,{size:20})," Apply for Resignation"]})}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-md border border-red-100 dark:border-red-900/50 mb-4 text-sm text-red-800 dark:text-red-200",children:[e.jsx("p",{className:"font-bold mb-1",children:"Notice Policy"}),e.jsxs("p",{children:["The standard notice period is ",e.jsx("strong",{children:"30 days"}),". Submitting this request initiates the process. Your final relieving date is subject to manager approval and handover completion."]})]}),e.jsxs("form",{onSubmit:x(o=>c.mutate(o)),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Last Working Day (Requested)"}),e.jsx("input",{type:"date",...l("requested_relieving_date"),className:"w-full p-2 border border-input bg-background rounded-md"}),r.requested_relieving_date&&e.jsx("p",{className:"text-red-500 text-xs",children:r.requested_relieving_date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Reason for Leaving"}),e.jsx("textarea",{...l("reason"),rows:4,placeholder:"Please provide a detailed reason...",className:"w-full p-2 border border-input bg-background rounded-md"}),r.reason&&e.jsx("p",{className:"text-red-500 text-xs",children:r.reason.message})]}),e.jsxs("div",{className:"flex items-start gap-2 pt-2",children:[e.jsx("input",{type:"checkbox",id:"confirm",...l("confirm"),className:"mt-1"}),e.jsx("label",{htmlFor:"confirm",className:"text-sm text-muted-foreground",children:"I understand that this action is formal and irreversible without approval. I agree to serve the notice period as per company policy."})]}),r.confirm&&e.jsx("p",{className:"text-red-500 text-xs ml-6",children:r.confirm.message}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm bg-muted hover:bg-muted/80 rounded-md",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:c.isPending,className:"px-4 py-2 text-sm bg-red-600 hover:bg-red-700 text-white rounded-md flex items-center gap-2",children:[c.isPending&&e.jsx(A,{className:"animate-spin",size:16}),"Submit Resignation"]})]})]})]})})},V=()=>{const[t,n]=f.useState(!1),{data:d,isLoading:m,error:g}=B({queryKey:["my-resignation"],queryFn:async()=>(await v.get("/team/resignation/my")).data}),l=Array.isArray(d)?d:[];l.find(r=>["APPLIED","UNDER_NOTICE"].includes(r.status));const x=l.length>0?l[0]:null;return m?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(A,{className:"animate-spin text-primary",size:32})}):g?e.jsx("div",{className:"text-red-500 text-center p-4",children:"Failed to load resignation status."}):e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[x&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Pe,{data:x}),(x.status==="REJECTED"||x.status==="COMPLETED")&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-border rounded-xl bg-card/50 text-center max-w-2xl mx-auto",children:[e.jsx("p",{className:"text-muted-foreground mb-4 font-medium",children:x.status==="REJECTED"?"Your previous request was rejected. You may submit a new application if needed.":"Your resignation process is complete. If you need to submit a new request, click below."}),e.jsxs(p,{variant:"destructive",onClick:()=>n(!0),className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(O,{size:18})," Re-Apply for Resignation"]})]})]}),!x&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border-2 border-dashed border-border rounded-xl bg-card/50 text-center max-w-2xl mx-auto mt-10",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4 text-primary",children:e.jsx(W,{size:32})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"No Active Resignation Request"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm",children:"You have not submitted any resignation request. If you wish to initiate the separation process, please click the button below."}),e.jsxs(p,{variant:"destructive",onClick:()=>n(!0),className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(O,{size:18})," Apply for Resignation"]})]}),l.length>0&&e.jsxs("div",{className:"border rounded-lg overflow-hidden shadow-sm bg-card",children:[e.jsx("div",{className:"p-4 border-b bg-muted/50 font-semibold",children:"Resignation History"}),e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-muted/50 text-muted-foreground",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 font-medium",children:"Applied On"}),e.jsx("th",{className:"p-3 font-medium",children:"Relieving Date"}),e.jsx("th",{className:"p-3 font-medium",children:"Notice Period"}),e.jsx("th",{className:"p-3 font-medium",children:"Days Left"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Status"})]})}),e.jsx("tbody",{children:l.map(r=>e.jsxs("tr",{className:"border-b last:border-0 hover:bg-muted/20",children:[e.jsx("td",{className:"p-3",children:b(new Date(r.applied_date),"dd MMM yyyy")}),e.jsxs("td",{className:"p-3",children:[b(new Date(r.approved_relieving_date||r.requested_relieving_date),"dd MMM yyyy"),r.status==="APPLIED"&&e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"(Req)"})]}),e.jsx("td",{className:"p-3",children:(()=>{const h=new Date(r.approved_relieving_date||r.requested_relieving_date),c=new Date(r.applied_date),o=h.getTime()-c.getTime();return`${Math.ceil(o/(1e3*60*60*24))} Days`})()}),e.jsx("td",{className:"p-3",children:(()=>{const h=new Date(r.approved_relieving_date||r.requested_relieving_date),c=new Date;c.setHours(0,0,0,0);const o=h.getTime()-c.getTime(),u=Math.ceil(o/(1e3*60*60*24));return u>0?e.jsxs("span",{className:"font-bold text-primary",children:[u," Days"]}):e.jsx("span",{className:"text-muted-foreground italic",children:"Passed"})})()}),e.jsx("td",{className:"p-3 text-right",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium 
                                            ${r.status==="APPROVED"||r.status==="UNDER_NOTICE"?"bg-blue-100 text-blue-700":r.status==="COMPLETED"?"bg-green-100 text-green-700":r.status==="REJECTED"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-800"}`,children:r.status})})]},r.id))})]})]}),e.jsx("div",{className:"max-w-2xl mx-auto text-xs text-center text-muted-foreground mt-8",children:e.jsx("p",{children:"Note: Submitting this request is a formal action. Please refer to the company's HR policy regarding notice periods and asset handover."})}),e.jsx(Ae,{isOpen:t,onClose:()=>n(!1)})]})},Ie=()=>{const t=H(),[n,d]=f.useState(null),[m,g]=f.useState(null),[l,x]=f.useState({}),[r,h]=f.useState({}),[c,o]=f.useState({}),{data:u,isLoading:R,isError:G}=B({queryKey:["all-resignations"],queryFn:async()=>(await v.get("/team/resignation")).data});w({mutationFn:async({id:s,date:i})=>await v.patch(`/team/resignation/${s}/approve`,{approved_relieving_date:i}),onSuccess:()=>{t.invalidateQueries({queryKey:["all-resignations"]}),alert("Resignation Approved & Notice Period Started."),x({}),o({})},onError:s=>{var i,a;return alert(((a=(i=s.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to approve")}});const I=w({mutationFn:async({id:s,data:i})=>await v.patch(`/team/resignation/${s}`,i),onSuccess:()=>{t.invalidateQueries({queryKey:["all-resignations"]}),alert("Record Updated Successfully."),o({}),x({}),h({})},onError:s=>{var i,a;return alert(((a=(i=s.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to update record")}});w({mutationFn:async s=>await v.patch(`/team/resignation/${s}/complete`),onSuccess:()=>{t.invalidateQueries({queryKey:["all-resignations"]}),alert("Resignation process marked as COMPLETED.")},onError:s=>{var i,a;return alert(((a=(i=s.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to complete")}});const C=w({mutationFn:async({id:s,reason:i})=>await v.patch(`/team/resignation/${s}/reject`,{reason:i}),onSuccess:()=>{t.invalidateQueries({queryKey:["all-resignations"]}),g(null),d(null)},onError:s=>{var i,a;return alert(((a=(i=s.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to reject")}}),T=w({mutationFn:async({id:s,days:i,reason:a})=>await v.patch(`/team/resignation/${s}/revise`,{days:i,reason:a}),onSuccess:()=>{t.invalidateQueries({queryKey:["all-resignations"]}),g(null),d(null)},onError:s=>{var i,a;return alert(((a=(i=s.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to revise")}}),Z=w({mutationFn:async s=>await v.delete(`/team/resignation/${s}`),onSuccess:()=>{t.invalidateQueries({queryKey:["all-resignations"]}),alert("Record Deleted.")},onError:s=>{var i,a;return alert(((a=(i=s.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to delete")}}),q=({request:s,onClose:i})=>{const[a,y]=f.useState("");return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{children:["Are you sure you want to reject the resignation for ",e.jsx("strong",{children:s.employee.full_name}),"?"]}),e.jsx("textarea",{className:"w-full border rounded p-2 bg-background",placeholder:"Reason for rejection...",value:a,onChange:j=>y(j.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(p,{variant:"outline",onClick:i,children:"Cancel"}),e.jsx(p,{variant:"destructive",onClick:()=>C.mutate({id:s.id,reason:a}),disabled:!a||C.isPending,children:C.isPending?"Rejecting...":"Reject Request"})]})]})},ee=({request:s,onClose:i})=>{const[a,y]=f.useState(s.final_notice_period_days||s.default_notice_period_days||30),[j,_]=f.useState(s.revision_reason||"");return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{children:["Revise notice period for ",e.jsx("strong",{children:s.employee.full_name}),"."]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"New Notice Period (Days)"}),e.jsx("input",{type:"number",className:"w-full border rounded p-2 bg-background",value:a,onChange:S=>y(Number(S.target.value)),min:0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Reason for Revision"}),e.jsx("textarea",{className:"w-full border rounded p-2 bg-background",placeholder:"Why is it being changed?",value:j,onChange:S=>_(S.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(p,{variant:"outline",onClick:i,children:"Cancel"}),e.jsx(p,{onClick:()=>T.mutate({id:s.id,days:a,reason:j}),disabled:!j||T.isPending,children:T.isPending?"Saving...":"Save Revision"})]})]})};return R?e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(A,{className:"animate-spin inline mr-2"})," Loading Requests..."]}):G?e.jsx("div",{className:"p-8 text-center text-red-500",children:"Failed to load resignation requests. Please try again."}):e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary/10 p-2 rounded-full text-primary",children:e.jsx(z,{size:20})}),"Resignation Requests"]}),e.jsx("div",{className:"border rounded-lg overflow-hidden shadow-sm bg-card",children:e.jsxs(ye,{children:[e.jsx(Ne,{children:e.jsxs(k,{children:[e.jsx(D,{children:"Employee"}),e.jsx(D,{children:"Applied On"}),e.jsx(D,{children:"Dates"}),e.jsx(D,{children:"Notice Period"}),e.jsx(D,{children:"Days Left"}),e.jsx(D,{children:"Status"}),e.jsx(D,{className:"text-right",children:"Actions"})]})}),e.jsxs(be,{children:[u==null?void 0:u.map(s=>{var i;return e.jsxs(k,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center overflow-hidden border border-border",children:s.employee.avatar_url?e.jsx("img",{src:de(s.employee.avatar_url),alt:"",className:"w-full h-full object-cover"}):e.jsx(z,{size:16,className:"text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:s.employee.full_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:((i=s.employee.staffProfile)==null?void 0:i.designation)||"Staff"})]})]})}),e.jsxs(N,{children:[e.jsx("div",{className:"text-sm text-foreground",children:b(new Date(s.applied_date),"dd MMM yyyy")}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 max-w-[200px] truncate italic",title:s.reason,children:['"',s.reason,'"']})]}),e.jsx(N,{children:e.jsx("div",{className:"space-y-1 text-sm",children:c[s.id]?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground w-8 text-xs",children:"Final:"}),e.jsx(oe,{type:"date",className:"h-8 w-32 p-1 text-xs",value:l[s.id]||(s.approved_relieving_date?new Date(s.approved_relieving_date).toISOString().split("T")[0]:new Date(s.requested_relieving_date).toISOString().split("T")[0]),onChange:a=>x({...l,[s.id]:a.target.value})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",title:"Requested Relieving Date",children:[e.jsx("span",{className:"text-muted-foreground w-8",children:"Req:"}),b(new Date(s.requested_relieving_date),"dd MMM yy")]}),s.approved_relieving_date&&e.jsxs("div",{className:"flex items-center gap-1 font-bold text-primary",title:"Approved Relieving Date",children:[e.jsx("span",{className:"text-muted-foreground w-8 font-normal",children:"Final:"}),b(new Date(s.approved_relieving_date),"dd MMM yy")]})]})})}),e.jsx(N,{children:e.jsx("div",{className:"text-sm",children:(()=>{const a=new Date(l[s.id]||s.approved_relieving_date||s.requested_relieving_date),y=new Date(s.applied_date),j=a.getTime()-y.getTime();return`${Math.ceil(j/(1e3*60*60*24))} Days`})()})}),e.jsx(N,{children:e.jsx("div",{className:"text-sm font-semibold",children:(()=>{const a=new Date(l[s.id]||s.approved_relieving_date||s.requested_relieving_date),y=new Date;y.setHours(0,0,0,0);const j=a.getTime()-y.getTime(),_=Math.ceil(j/(1e3*60*60*24));return _>0?`${_} Left`:"Today/Passed"})()})}),e.jsx(N,{children:c[s.id]?e.jsx("div",{className:"w-32",children:e.jsxs(De,{value:r[s.id]||s.status,onValueChange:a=>h({...r,[s.id]:a}),children:[e.jsx(we,{className:"h-8 text-xs",children:e.jsx(_e,{})}),e.jsxs(Re,{children:[e.jsx(E,{value:"APPLIED",children:"Applied"}),e.jsx(E,{value:"UNDER_NOTICE",children:"In Notice"}),e.jsx(E,{value:"REJECTED",children:"Rejected"}),e.jsx(E,{value:"COMPLETED",children:"Completed"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(X,{variant:s.status==="APPLIED"?"outline":s.status==="UNDER_NOTICE"?"default":"secondary",className:"capitalize",children:s.status==="UNDER_NOTICE"?"In Notice":s.status.toLowerCase().replace("_"," ")}),s.status==="UNDER_NOTICE"&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-1 rounded border border-orange-200 dark:border-orange-800 w-fit",children:[e.jsx("span",{className:"text-xs font-semibold",children:"Remaining:"}),e.jsxs("span",{className:"text-sm font-bold",children:[s.remaining_days," Days"]})]})]})}),e.jsx(N,{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:c[s.id]?e.jsxs(e.Fragment,{children:[e.jsxs(p,{size:"sm",variant:"default",className:"bg-green-600 hover:bg-green-700 h-8 text-xs gap-1",onClick:()=>I.mutate({id:s.id,data:{status:r[s.id]||s.status,approved_relieving_date:l[s.id]?new Date(l[s.id]):s.approved_relieving_date}}),disabled:I.isPending,children:[e.jsx(Ee,{size:14})," Save"]}),e.jsx(p,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>{o({...c,[s.id]:!1}),x({...l,[s.id]:""}),h({...r,[s.id]:""})},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{size:"sm",variant:"outline",className:"text-primary border-primary/20 hover:bg-primary/5 h-8 text-xs gap-1",onClick:()=>o({...c,[s.id]:!0}),children:[e.jsx(Ce,{size:14})," Edit"]}),s.status==="APPLIED"&&e.jsxs(p,{size:"sm",variant:"outline",className:"text-red-500 border-red-100 hover:bg-red-50 h-8 text-xs",onClick:()=>{d(s),g("REJECT")},children:[e.jsx(ce,{size:14})," Reject"]}),e.jsxs(p,{size:"sm",variant:"secondary",className:"h-8 text-xs text-red-600 bg-red-50 hover:bg-red-100 border-red-100 gap-1",onClick:()=>{confirm("Delete this record permanently?")&&Z.mutate(s.id)},children:[e.jsx(me,{size:14})," Delete"]})]})})})]},s.id)}),u&&u.length===0&&e.jsx(k,{children:e.jsxs(N,{colSpan:5,className:"text-center h-32 text-muted-foreground flex flex-col items-center justify-center w-full",children:[e.jsx("div",{className:"mb-2 bg-muted p-2 rounded-full",children:e.jsx(xe,{className:"text-muted-foreground"})}),"No active resignation requests."]})})]})]})}),e.jsx(J,{open:!!n,onOpenChange:s=>!s&&d(null),children:e.jsxs(K,{children:[e.jsx(Q,{children:e.jsx(Y,{children:m==="REVISE"?"Revise Notice Period":"Reject Request"})}),n&&m==="REVISE"&&e.jsx(ee,{request:n,onClose:()=>d(null)}),n&&m==="REJECT"&&e.jsx(q,{request:n,onClose:()=>d(null)})]})})]})},Ze=()=>{const{user:t}=te();return(t==null?void 0:t.role)===M.ADMIN||(t==null?void 0:t.role)===M.MANAGER||(t==null?void 0:t.role)===M.DEVELOPER_ADMIN?e.jsxs("div",{className:"p-6 h-full flex flex-col",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Relieve / Resignation"}),e.jsxs(Te,{defaultValue:"team",className:"h-full flex flex-col",children:[e.jsxs(Se,{className:"bg-muted w-fit mb-6",children:[e.jsxs(U,{value:"team",className:"flex items-center gap-2",children:[e.jsx(ue,{size:16})," Team Requests"]}),e.jsxs(U,{value:"my",className:"flex items-center gap-2",children:[e.jsx(W,{size:16})," My Application"]})]}),e.jsx($,{value:"team",className:"flex-1 overflow-auto",children:e.jsx(Ie,{})}),e.jsx($,{value:"my",className:"flex-1 overflow-auto",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(V,{})})})]})]}):e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Relieve / Resignation"}),e.jsx(V,{})]})};export{Ze as default};
