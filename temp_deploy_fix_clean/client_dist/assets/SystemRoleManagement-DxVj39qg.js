import{q as h,r as g,u as y,j as e,N,x as c}from"./index-_K9dBzXA.js";import{u as j,i as v,J as E,m as b}from"./index-C0_MxDCy.js";import{L as A}from"./loader-2-m9uN2hHg.js";const D=()=>{const d=h(),[o,t]=g.useState(null),{data:l,isLoading:u}=j({queryKey:["staff"],queryFn:async()=>(await c.get("/team/staff")).data}),m=v({mutationFn:async({id:s,role:a})=>{await c.patch(`/team/staff/${s}`,{role:a})},onSuccess:()=>{d.invalidateQueries({queryKey:["staff"]}),t(null),alert("Role updated successfully!")},onError:s=>{var n,i;t(null);const a=(i=(n=s.response)==null?void 0:n.data)==null?void 0:i.message;alert("Failed to update role: "+(typeof a=="object"?JSON.stringify(a,null,2):a||s.message))}}),x=(s,a)=>{window.confirm(`Are you sure you want to change this user's role to ${a}?`)&&(t(s),m.mutate({id:s,role:a}))},p=[{value:"ADMIN",label:"Admin (Full Access)"},{value:"MANAGER",label:"Manager (Team & Reports)"},{value:"MARKETING_EXEC",label:"Marketing Exec"},{value:"CREATIVE_DESIGNER",label:"Designer"},{value:"WEB_SEO_EXECUTIVE",label:"Web & SEO Specialist"}],{user:r}=y();return u?e.jsx("div",{className:"p-8 text-center",children:"Loading staff list..."}):!r||r.role!=="ADMIN"&&r.role!=="DEVELOPER_ADMIN"?e.jsx(N,{to:"/dashboard",replace:!0}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"System Role Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Assign system access levels and roles to team members."})]}),e.jsx("div",{className:"bg-card border rounded-lg overflow-hidden shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50/50 text-gray-500 font-medium border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Employee"}),e.jsx("th",{className:"px-6 py-4",children:"Email"}),e.jsx("th",{className:"px-6 py-4",children:"Department"}),e.jsx("th",{className:"px-6 py-4",children:"Current Role"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y",children:l==null?void 0:l.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50/30",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs overflow-hidden",children:s.user.avatar_url?e.jsx("img",{src:E(s.user.avatar_url),alt:"Avatar",className:"w-full h-full object-cover"}):s.user.full_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.user.full_name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.designation})]})]})}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:s.user.email}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:s.department.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{size:14,className:s.user.role==="ADMIN"||s.user.role==="DEVELOPER_ADMIN"?"text-purple-600":"text-gray-400"}),e.jsx("span",{className:`font-medium ${s.user.role==="ADMIN"||s.user.role==="DEVELOPER_ADMIN"?"text-purple-700":"text-gray-700"}`,children:s.user.role})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:o===s.id?e.jsx("div",{className:"flex justify-end",children:e.jsx(A,{className:"animate-spin text-primary",size:18})}):e.jsx("select",{className:"bg-background border rounded-md text-xs py-1.5 px-2 focus:ring-2 focus:ring-primary/20 focus:outline-none",value:s.user.role,onChange:a=>x(s.id,a.target.value),children:p.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})})]},s.id))})]})})})]})};export{D as default};
